var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(a,s){function n(t){try{h(r.next(t))}catch(e){s(e)}}function o(t){try{h(r["throw"](t))}catch(e){s(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,o)}h((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,s&&(n=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(s,i[1])).done)return n;switch(s=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(n=h.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){h.label=i[1];break}if(6===i[0]&&h.label<n[1]){h.label=n[1],n=i;break}if(n&&h.label<n[2]){h.label=n[2],h.ops.push(i);break}n[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(r){i=[6,r],s=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,n,o,h={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},BaseScene=function(t){function e(){var e=t.call(this)||this;return e.isShow=!1,e.timeItem=null,e.scoreItem=null,e.dataVo=GameData.getLevelConfig(),e}return __extends(e,t),e.prototype.enter=function(){this.isShow||(this.isShow=!0,Game.instance().addBottom(this))},e.prototype.exit=function(){this.isShow=!1,this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(BaseScene.prototype,"BaseScene");var BaseView=function(t){function e(){var e=t.call(this)||this;return e.isOpen=!1,e}return __extends(e,t),e.prototype.open=function(){this.isOpen||(this.isOpen=!0,Game.instance().addTop(this))},e.prototype.close=function(){this.isOpen=!1,this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);__reflect(BaseView.prototype,"BaseView");var Scene_012=function(t){function e(){var e=t.call(this)||this;return e.isTouching=!1,e.vsArr=[],e.lineCount=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.lineVs=this.dataVo.sData;var e=this.dataVo.tData,i=e.length;this.lineEs=[];for(var r=0;i>r;r++){var a=e[r];this.lineEs.push({start:this.lineVs[a[0]],end:this.lineVs[a[1]]})}this.drawLines(),this.pathShape=new egret.Shape,this.addChild(this.pathShape),this.drawCircles(),this.paths=[],this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem);var s=SpriteUtil.createButton("重来",140,60,255,28);s.x=SpriteUtil.stageCenterX-s.width/2,s.y=SpriteUtil.stageHeight-300,this.addChild(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.pathShape.graphics.clear(),t.paths=[],t.lineEs=[];for(var r=0;i>r;r++){var a=e[r];t.lineEs.push({start:t.lineVs[a[0]],end:t.lineVs[a[1]]})}for(var s=0,n=t.vsArr;s<n.length;s++){var o=n[s];o.alpha=.5}},this)},e.prototype.touchHandler=function(t){var e={x:t.stageX,y:t.stageY};this.paths.push(e),this.drawPath()},e.prototype.clkStart=function(t){if(!(this.timeItem.leftTime<=0)){GameSound.instance().playSound("click");var e=t.target,i=e.name,r=i.split("_")[1],a=this.lineVs[r];if(this.isCanDraw(a)){if(e.alpha=1,this.drawPath(),0==this.lineEs.length){var s=this.timeItem.leftTime;this.timeItem.stop();var n=egret.setTimeout(function(){egret.clearTimeout(n),s>=60?EffectUtil.showResultEffect(EffectUtil.PERFECT):s>=45?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)},this,200)}}else{var o=1==e.alpha?.5:1;egret.Tween.get(e).to({alpha:o},300).to({alpha:e.alpha},300).call(function(){egret.Tween.removeTweens(e)})}}},e.prototype.isCanDraw=function(t){var e=this.paths.length;if(0==e)return this.paths.push(t),!0;for(var i=this.paths[e-1],r=t,a=this.lineEs.length,s=a-1;s>=0;s--){var n=this.lineEs[s].start,o=this.lineEs[s].end;if(i.x==n.x&&r.x==o.x&&i.y==n.y&&r.y==o.y)return this.lineEs.splice(s,1),this.paths.push(t),!0;if(i.x==o.x&&i.y==o.y&&n.x==r.x&&n.y==r.y)return this.lineEs.splice(s,1),this.paths.push(t),!0}return!1},e.prototype.drawPath=function(){if(this.pathShape.graphics.clear(),0!=this.paths.length){this.pathShape.graphics.lineStyle(10,16711680),this.pathShape.graphics.moveTo(this.paths[0].x,this.paths[0].y);for(var t=1;t<this.paths.length;t++){var e=this.paths[t];this.pathShape.graphics.lineTo(e.x,e.y)}}},e.prototype.drawLines=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.lineStyle(10,8046029,.8);for(var e=0;e<this.lineEs.length;e++){var i=this.lineEs[e].start,r=this.lineEs[e].end;t.graphics.moveTo(i.x,i.y),t.graphics.lineTo(r.x,r.y)}this.addChild(t)},e.prototype.drawCircles=function(){this.vsArr=[];for(var t=0;t<this.lineVs.length;t++){var e=new egret.Shape,i=this.lineVs[t];e.graphics.lineStyle(1,0),e.graphics.beginFill(16777215),e.graphics.drawCircle(i.x,i.y,20),e.graphics.endFill(),e.alpha=.5,this.addChild(e),e.name="vertex_"+t,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkStart,this),e.touchEnabled=!0,this.vsArr.push(e)}},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){t.prototype.exit.call(this);for(var e=0,i=this.vsArr;e<i.length;e++){var r=i[e];r.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clkStart,this),r.parent&&r.parent.removeChild(r)}},e}(BaseScene);__reflect(Scene_012.prototype,"Scene_012");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.error(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),[4,RES.getResAsync("config_json")];case 2:return t=e.sent(),GameData.gameConfig=t,this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){var t=new egret.Bitmap(RES.getRes("bg_png"));this.stage.addChild(t),Game.instance().setStage(this.stage),t.height=this.stage.stageHeight},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var EventCenter=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.instance=function(){return null==this._instance&&(this._instance=new e),this._instance},e}(egret.EventDispatcher);__reflect(EventCenter.prototype,"EventCenter");var GameData=function(){function t(){}return t.getLevelConfig=function(){var t=new DataVO;if(0==this.currentChapter)return t;var e=this.currentChapter>=10?"chapter0"+this.currentChapter:"chapter00"+this.currentChapter;return t.setData(this.gameConfig.levels[e][this.currentLevel]),t},t.getConfig=function(t){return t?this.gameConfig.config[t]:void 0},t.isChapterPassed=function(){var t=this.currentChapter>=10?"chapter0"+this.currentChapter:"chapter00"+this.currentChapter,e=this.gameConfig.levels[t],i=e.length;return this.currentLevel>=i?!0:!1},t.isRunGame=!1,t.isWxGame=!0,t.currentChapter=0,t.currentLevel=0,t.reviveCard=1,t.shareConf=[{title:"有人@你！这个挑战有点意思！",head:"resource/assets/head0.png"},{title:"有人@你！你能找到这顶帽子吗？",head:"resource/assets/head1.png"},{title:"有人@你！猴子能吃到多少水果？",head:"resource/assets/head2.png"},{title:"有人@你！你能微控小球旋转几圈？",head:"resource/assets/head3.png"}],t}();__reflect(GameData.prototype,"GameData");var GameScene=function(){function t(){this.init()}return t.prototype.init=function(){this._menuScene=new MenuScene,this._overScene=new OverScene,this._chapterScene=new ChapterScene,this.allScenes={},this.allScenes["000"]=Scene_000,this.allScenes["001"]=Scene_001,this.allScenes["002"]=Scene_002,this.allScenes["003"]=Scene_003,this.allScenes["004"]=Scene_004,this.allScenes["005"]=Scene_005,this.allScenes["006"]=Scene_006,this.allScenes["007"]=Scene_007,this.allScenes["008"]=Scene_008,this.allScenes["009"]=Scene_009,this.allScenes["010"]=Scene_010,this.allScenes["011"]=Scene_011,this.allScenes["012"]=Scene_012,this.allScenes["013"]=Scene_013,this.allScenes["014"]=Scene_014,this.allScenes["015"]=Scene_015,this.allScenes["016"]=Scene_016,this.allScenes["017"]=Scene_017,this.allScenes["018"]=Scene_018,this.allScenes["019"]=Scene_019,this.allScenes["020"]=Scene_020,this.allScenes["021"]=Scene_021,this.allScenes["022"]=Scene_022,this.allScenes["023"]=Scene_023,this.allScenes["024"]=Scene_024,this.allScenes["025"]=Scene_025,this.allScenes["026"]=Scene_026,this.allScenes["027"]=Scene_027,this.allScenes["028"]=Scene_028,this.allScenes["029"]=Scene_029,this.allScenes["030"]=Scene_030,this.allScenes["031"]=Scene_031,this.allScenes["032"]=Scene_032,this.addEvent()},t.prototype.addEvent=function(){EventCenter.instance().addEventListener(GameEvent.START_GAME,this.startGame,this),EventCenter.instance().addEventListener(GameEvent.GOT0_CHAPTER,this.nextChapter,this),EventCenter.instance().addEventListener(GameEvent.GOTO_NEXT_LEVEL,this.gotoNext,this)},t.prototype.enterMenu=function(){this._currentScene&&this._currentScene.exit(),this._menuScene.enter(),this._currentScene=this._menuScene,GameSound.instance().stopMusic(),WXApi.showBannerAd()},t.prototype.enterOver=function(){this._currentScene&&this._currentScene.exit(),this._overScene.enter(),this._currentScene=this._overScene,GameData.currentChapter=0,GameSound.instance().stopMusic(),WXApi.showBannerAd()},t.prototype.enterChapter=function(){this._currentScene&&this._currentScene.exit(),this._chapterScene.enter(),this._currentScene=this._chapterScene,GameSound.instance().stopMusic(),WXApi.showBannerAd()},t.prototype.nextChapter=function(){var t=GameData.currentChapter;GameData.currentLevel=-1,this.gotoNext(),3==t||6==t||7==t||19==t||22==t?WXApi.showBannerAd(!1):WXApi.showBannerAd(!0)},t.prototype.gotoNext=function(t){if(void 0===t&&(t=null),GameData.currentLevel++,GameData.isChapterPassed()){var e=GameData.currentChapter;return e++,WXApi.updateRankLvl(e),void this.enterChapter()}Game.instance().gameView.guideView.show(),this._currentScene&&(this._currentScene.exit(),GameSound.instance().stopMusic())},t.prototype.startGame=function(t){void 0===t&&(t=null),GameSound.instance().playMusic();var e=GameData.getLevelConfig();e.levelType||(e.levelType="000"),this._currentScene=new this.allScenes[e.levelType],this._currentScene.enter()},t}();__reflect(GameScene.prototype,"GameScene");var GameSound=function(){function t(){this.audio_url="resource/assets/sound/",this._sound=null,this._music=null,this.soundsVec={good:this.audio_url+"good.mp3",great:this.audio_url+"great.mp3",perfect:this.audio_url+"perfect.mp3",fail:this.audio_url+"fail.mp3",ready:this.audio_url+"readyGo.mp3",wrong:this.audio_url+"wrong.mp3",click:this.audio_url+"click.mp3"}}return t.instance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.playMusic=function(){var t=this;if(GameData.isWxGame){if(null==this._music)return this._music=WXApi.createInnerAudioContext(this.audio_url+"bg.mp3"),this._music.loop=!0,void this._music.onCanplay(function(){t._music.play(),t._music.offCanplay()});this.stopMusic(),this._music.play()}else this.playWebSound(this.audio_url+"bg.mp3",-1)},t.prototype.stopMusic=function(){this._music&&this._music.stop()},t.prototype.playSound=function(t){this._sound&&(this._sound.stop(),this._sound.destroy()),GameData.isWxGame?this.playWxSound(this.soundsVec[t]):this.playWebSound(this.soundsVec[t])},t.prototype.playWxSound=function(t){this._sound=WXApi.createInnerAudioContext(t),this._sound.play(),this._sound.loop=!1},t.prototype.playWebSound=function(t,e){void 0===e&&(e=1);try{var i=new egret.Sound;i.addEventListener(egret.Event.COMPLETE,function(t){try{i.play(0,e)}catch(r){console.log(r)}},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){console.log("loaded error!")},this),i.load(t)}catch(r){console.log(r)}},t._instance=null,t}();__reflect(GameSound.prototype,"GameSound");var GameView=function(){function t(){this.init()}return t.prototype.init=function(){this._guideView=new GuideView,this._rankView=new RankView,this._tipsView=new TipsView},Object.defineProperty(t.prototype,"guideView",{get:function(){return this._guideView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rankView",{get:function(){return this._rankView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tipsView",{get:function(){return this._tipsView},enumerable:!0,configurable:!0}),t}();__reflect(GameView.prototype,"GameView");var GameEvent=function(t){function e(e,i,r,a){var s=t.call(this,e,i,r,a)||this;return s.data=null,s}return __extends(e,t),e.START_GAME="game_start",e.GOT0_CHAPTER="goto_next_chapter",e.GOTO_NEXT_LEVEL="goto_next_level",e.AUTHORIZE_REFRESH="authorize_refresh",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var ScoreItem=function(t){function e(){var e=t.call(this)||this;return e.score=0,e.tarScore=0,e.tarLose=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.scoreTxt=new egret.TextField,this.scoreTxt.size=32,this.scoreTxt.text="0",this.scoreTxt.textColor=65280,this.scoreTxt.width=300,this.scoreTxt.stroke=.5,this.scoreTxt.bold=!0,this.scoreTxt.strokeColor=0,this.addChild(this.scoreTxt),this.y=30,this.x=30},e.prototype.setSTScore=function(t,e){this.score=t,e&&(this.tarScore=e),this.scoreTxt.text="分数 "+this.score+"  目标 "+this.tarScore},e.prototype.setSTLose=function(t,e){this.score=t,e&&(this.tarLose=e),this.scoreTxt.text="已用 "+this.score+"  总数 "+this.tarLose},e.prototype.setCustomText=function(t){void 0===t&&(t=""),this.scoreTxt.text=t},e.prototype.isCanPass=function(){return this.score>=this.tarScore?!0:!1},e}(egret.Sprite);__reflect(ScoreItem.prototype,"ScoreItem");var TimeItem=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i._leftTime=0,i.callBackContext=null,i._leftTime=e,i.init(),i}return __extends(e,t),e.prototype.init=function(){this.timeTxt=new egret.TextField,this.timeTxt.width=240,this.timeTxt.size=32,this.timeTxt.textColor=15597806,this.timeTxt.stroke=.5,this.timeTxt.strokeColor=0,this.timeTxt.bold=!0,this.timeTxt.text="剩余时间  "+CommonUtil.getMSTimeBySeconds(this._leftTime),this.y=30,this.x=(SpriteUtil.stageWidth-200)/2,this.addChild(this.timeTxt)},e.prototype.start=function(t,e){void 0===e&&(e=null),this.timer=new egret.Timer(1e3),this.loop=t,this.callBackContext=e,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerTick,this),this.timer.start()},e.prototype.restart=function(t,e,i){void 0===t&&(t=0),void 0===i&&(i=null),this._leftTime=t,this.timeTxt.text="剩余时间  "+CommonUtil.getMSTimeBySeconds(this._leftTime),this.timer=new egret.Timer(1e3),this.loop=e,this.callBackContext=i,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerTick,this),this.timer.start()},Object.defineProperty(e.prototype,"leftTime",{get:function(){return this._leftTime},enumerable:!0,configurable:!0}),e.prototype.timerTick=function(){return this._leftTime--,this.timeTxt.text="剩余时间  "+CommonUtil.getMSTimeBySeconds(this._leftTime),this.loop?void this.loop.call(this.callBackContext,this._leftTime):void(this._leftTime<=0&&(this.loop||EffectUtil.showResultEffect(),this.stop()))},e.prototype.stop=function(){this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerTick,this),this.timer=null),this._leftTime=0,this.loop=null,this.callBackContext=null},e}(egret.Sprite);__reflect(TimeItem.prototype,"TimeItem");var EgretRender=function(){function t(){}return t.create=function(e){var i={controller:t,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#fafafa",wireframeBackground:"#222222",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},r=Matter.Common.extend(i,e);return r.mouse=e.mouse,r.engine=e.engine,r.container=r.container||egret.MainContext.instance.stage,r.bounds=r.bounds||{min:{x:0,y:0},max:{x:r.width,y:r.height}},r},t.run=function(e){this.render=e,egret.startTick(this.loop,t)},t.loop=function(e){return t.world(this.render),!1},t.stop=function(e){void 0===e&&(e=null),egret.stopTick(this.loop,t),this.render=null},t.world=function(e){var i=e.engine,r=i.world,a=(e.renderer,e.container),s=e.options,n=Matter.Composite.allBodies(r),o=Matter.Composite.allConstraints(r),h=[],l=e.bounds.max.x-e.bounds.min.x,c=e.bounds.max.y-e.bounds.min.y,d=l/e.options.width,p=c/e.options.height;if(s.hasBounds){for(var g=0;g<n.length;g++){var f=n[g];f.render.sprite.visible=Matter.Bounds.overlaps(f.bounds,e.bounds)}for(var u=0;u<o.length;u++){var m=o[u],v=m.bodyA,S=m.bodyB,y=m.pointA,x=m.pointB;v&&(y=Matter.Vector.add(v.position,m.pointA,null)),S&&(x=Matter.Vector.add(S.position,m.pointB,null)),y&&x&&(Matter.Bounds.contains(e.bounds,y)||Matter.Bounds.contains(e.bounds,x))&&h.push(m)}a.scaleX=1/d,a.scaleY=1/p,a.x=-e.bounds.min.x*(1/d),a.y=-e.bounds.min.y*(1/p)}else h=o;for(g=0;g<n.length;g++)t.body(e,n[g]);for(g=0;g<h.length;g++)t.constraint(e,h[g])},t.body=function(e,i){var r=(e.engine,i.render);if(r.visible)if(r.sprite instanceof egret.DisplayObject){var a=("b-"+i.id,i.egretSprite),s=e.container;a||(a=i.egretSprite=i.render.sprite),s.contains(a)||s.addChild(a),a.x=i.position.x,a.y=i.position.y,a.rotation=180*i.angle/Math.PI}else{var a=("b-"+i.id,i.egretSprite),s=e.container;a&&s.removeChild(a),a=i.egretSprite=t._createBodyPrimitive(e,i),a.initAngle=i.angle,s.contains(a)||s.addChild(a),a.x=i.position.x,a.y=i.position.y,a.rotation=180*(i.angle-a.initAngle)/Math.PI}},t._createBodyPrimitive=function(t,e){var i,r,a,s,n=e.render,o=t.options,h=new MatterSprite,l=[],c=h.graphics;c.clear();for(var d=e.parts.length>1?1:0;d<e.parts.length;d++){s=e.parts[d],o.wireframes?(i="transparent",r=16711680,a=1):(i=n.fillStyle,r=n.strokeStyle,a=n.lineWidth);for(var p=0;p<s.vertices.length;p++)l.push([s.vertices[p].x-e.position.x,s.vertices[p].y-e.position.y]);c.beginFill(i),c.lineStyle(a,r),c.moveTo(l[0][0],l[0][1]);for(var g=1;g<l.length;g++)c.lineTo(l[g][0],l[g][1]);c.lineTo(l[0][0],l[0][1]),c.endFill()}return h},t.constraint=function(t,e){var i=(t.engine,e.bodyA),r=e.bodyB,a=e.pointA,s=e.pointB,n=t.container,o=e.render,h=("c-"+e.id,e.egretSprite);h||(h=e.egretSprite=new MatterSprite);var l=h.graphics;if(!o.visible||!e.pointA||!e.pointB)return void l.clear();n.contains(h)||n.addChild(h),l.clear();var c,d,p,g;i?(c=i.position.x+a.x,d=i.position.y+a.y):(c=a.x,d=a.y),r?(p=r.position.x+s.x,g=r.position.y+s.y):(p=s.x,g=s.y);var f=65280;l.lineStyle(1,f),l.moveTo(c,d),l.lineTo(p,g),l.endFill()},t.render=null,t}();__reflect(EgretRender.prototype,"EgretRender");var MatterSprite=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.Sprite);__reflect(MatterSprite.prototype,"MatterSprite");var ChapterScene=function(t){function e(){var e=t.call(this)||this;return e.listArr=[],e.chaptersArr=[],e.distance=new egret.Point(0,0),e.currentListIndex=0,e.isTouching=!1,e.isCanOperate=!0,e.maxPage=2,e.init(),e}return __extends(e,t),e.prototype.init=function(){for(var t=this,e=(GameData.gameConfig.levels,0);e<this.maxPage;e++)this.listArr.push(this.createList(e));this.addChild(this.listArr[0]),this.leftBtn=SpriteUtil.createImage("arrow"),this.leftBtn.x=SpriteUtil.stageCenterX-180,this.leftBtn.y=this.listArr[0].y+this.listArr[0].height+100,this.leftBtn.scaleX=3.2,this.leftBtn.scaleY=2.2,this.addChild(this.leftBtn),this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.isCanOperate&&t.nextPage(-1)},this),this.leftBtn.visible=!1,this.rightBtn=SpriteUtil.createImage("arrow"),this.rightBtn.x=SpriteUtil.stageCenterX+180,this.rightBtn.y=this.leftBtn.y,this.rightBtn.scaleX=-3.2,this.rightBtn.scaleY=2.2,this.addChild(this.rightBtn),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.isCanOperate&&t.nextPage(1)},this);var i=SpriteUtil.createImage("home");i.x=80,i.y=80,i.scaleX=1.4,i.scaleY=1.5,this.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Game.instance().gameScene.enterMenu()},this)},e.prototype.nextPage=function(t){var e=this;void 0===t&&(t=0);var i=this.listArr[this.currentListIndex];if(GameSound.instance().playSound("click"),0==t)return i&&i.parent&&i.parent.removeChild(i),this.currentListIndex=0,this.listArr[0].alpha=1,this.listArr[0].x=SpriteUtil.stageCenterX-this.listArr[0].width/2,this.addChild(this.listArr[0]),this.leftBtn.visible=!1,void(this.rightBtn.visible=!0);if(this.currentListIndex+=t,this.currentListIndex<0)return void(this.currentListIndex=0);if(this.currentListIndex>=this.maxPage)return void(this.currentListIndex=this.maxPage-1);0==this.currentListIndex?this.leftBtn.visible=!1:this.leftBtn.visible=!0,this.currentListIndex==this.maxPage-1?this.rightBtn.visible=!1:this.rightBtn.visible=!0;var r=this.listArr[this.currentListIndex],a=i.x,s=i.x;0>t?(r.x=-i.width,s=SpriteUtil.stageWidth):t>0&&(r.x=SpriteUtil.stageWidth,s=-i.width),r.alpha=0,this.addChild(r),0!=t&&(this.isCanOperate=!1,egret.Tween.get(i).to({x:s,alpha:0},500).call(function(){egret.Tween.removeTweens(i),i.parent&&i.parent.removeChild(i)}),egret.Tween.get(r).to({x:a,alpha:1},500).call(function(){egret.Tween.removeTweens(r),e.isCanOperate=!0}))},e.prototype.createList=function(t){void 0===t&&(t=0);var e=new egret.Sprite,i=SpriteUtil.createRect(640,640,0);i.alpha=.5,i.anchorOffsetX=0,i.anchorOffsetY=0,e.addChild(i);for(var r=0;16>r;r++){var a=this.createBtns(r+1+16*t);a.x=80+160*(r%4),a.y=80+160*Math.floor(r/4),a.scaleX=1.5,a.scaleY=1.5,e.addChild(a),this.chaptersArr.push(a)}return e.x=SpriteUtil.stageCenterX-e.width/2,e.y=200,e.touchEnabled=!0,e},e.prototype.createBtns=function(t){var e=new egret.Sprite,i=SpriteUtil.createImage("circle");i.touchEnabled=!1,i.visible=!1,this.addChild(i);var r=SpriteUtil.createText(""+t,48,16776960);r.touchEnabled=!1,r.visible=!1,e.addChild(i),e.addChild(r),e.name="btn_"+t;var a=SpriteUtil.createImage("lock");return a.touchEnabled=!1,e.addChild(a),e.touchEnabled=!1,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectChapter,this),e},e.prototype.selectChapter=function(t){GameSound.instance().playSound("click");var e=t.target.name,i=e.split("_")[1];GameData.currentChapter=parseInt(i),EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.GOT0_CHAPTER))},e.prototype.refresh=function(){var t=(this.chaptersArr.length,egret.localStorage.getItem("very_funny_small_game_chapter"));t||(t="1",WXApi.updateRankLvl(parseInt(t))),parseInt(t)>32&&(t="32");for(var e=0;e<parseInt(t);e++){var i=this.chaptersArr[e];i.getChildAt(0).visible=!0,i.getChildAt(1).visible=!0,i.getChildAt(2).visible=!1,i.touchEnabled=!0}},e.prototype.enter=function(){this.refresh(),this.nextPage(0),t.prototype.enter.call(this)},e}(BaseScene);__reflect(ChapterScene.prototype,"ChapterScene");var MenuScene=function(t){function e(){var e=t.call(this)||this;return e.isInitOpenDataCtx=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Bitmap(RES.getRes("home_json#logo"));t.anchorOffsetX=t.width/2,t.x=SpriteUtil.stageCenterX,t.y=120,this.addChild(t);var e=new egret.Bitmap(RES.getRes("home_json#social"));e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY-20,e.scaleX=2,e.scaleY=2,this.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.instance().playSound("click"),Game.instance().gameScene.enterChapter()},this),this.startBtn=e;var i=SpriteUtil.createImage("rank");i.x=SpriteUtil.stageCenterX-100,i.y=e.y+220,i.scaleX=1.5,i.scaleY=1.5,this.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.isWxGame&&(GameSound.instance().playSound("click"),Game.instance().gameView.rankView.open())},this);var r=SpriteUtil.createImage("share");if(r.x=SpriteUtil.stageCenterX+100,r.y=e.y+220,r.scaleX=1.5,r.scaleY=1.5,this.addChild(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.isWxGame&&WXApi.shareAppMessage()},this),GameData.isWxGame){var a=new egret.Sprite,s=new egret.Bitmap(RES.getRes("home_json#zhijian"));s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=s.width/2,this.addChild(s),s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.isWxGame&&WXApi.navigateToMiniProgram("wxf461dfd74e17709f")},this),a.addChild(s);var n=new egret.Bitmap(RES.getRes("home_json#qiuqiuhome"));n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=s.x+s.width+40,this.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.isWxGame&&WXApi.navigateToMiniProgram("wxe79f94f71d43ffd7")},this),a.addChild(n);var o=new egret.Bitmap(RES.getRes("home_json#migong"));o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=n.x+n.width+40,this.addChild(o),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.isWxGame&&WXApi.navigateToMiniProgram("wx8bc01658647ef87a")},this),a.addChild(o),a.x=SpriteUtil.stageCenterX-a.width/2,a.y=i.y+i.height+50,this.addChild(a),this.gameClubBtn=WXApi.createGameClubButton(),EventCenter.instance().addEventListener(GameEvent.AUTHORIZE_REFRESH,this.initOpenData,this),WXApi.getSetting()}},e.prototype.initOpenData=function(){EventCenter.instance().removeEventListener(GameEvent.AUTHORIZE_REFRESH,this.initOpenData,this);var t=egret.localStorage.getItem("very_funny_small_game_user_avatar_url");if(!this.isInitOpenDataCtx){this.isInitOpenDataCtx=!0;var e=platform.openDataContext;e.postMessage({command:"cmd_openId",openId:t})}},e.prototype.enter=function(){t.prototype.enter.call(this),egret.Tween.get(this.startBtn,{loop:!0}).to({scaleX:2.2,scaleY:2.2},1500).to({scaleX:2,scaleY:2},1500),GameData.isWxGame&&this.gameClubBtn.show()},e.prototype.exit=function(){t.prototype.exit.call(this),GameData.isWxGame&&this.gameClubBtn.hide(),egret.Tween.removeTweens(this.startBtn),this.startBtn.scaleX=2,this.startBtn.scaleY=2},e}(BaseScene);__reflect(MenuScene.prototype,"MenuScene");var OverScene=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Bitmap(RES.getRes("home_json#lose"));t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.scaleX=1.5,t.scaleY=3,t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY-300,this.addChild(t);var e=SpriteUtil.createText(">> 继 续 <<",60,16776960);e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY-80,e.touchEnabled=!0,this.addChild(e),EffectUtil.breath(e,.05);var i=SpriteUtil.createText(">> 菜 单 <<",60,16776960);i.x=SpriteUtil.stageCenterX,i.y=SpriteUtil.stageCenterY+20,i.touchEnabled=!0,this.addChild(i),EffectUtil.breath(i,.05);var r=SpriteUtil.createText(">> 分 享 <<",60,16776960);r.x=SpriteUtil.stageCenterX,r.y=SpriteUtil.stageCenterY+120,r.touchEnabled=!0,this.addChild(r),EffectUtil.breath(r,.05),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.instance().playSound("click"),Game.instance().gameScene.enterChapter()},this),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.instance().playSound("click"),Game.instance().gameScene.enterMenu()},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.instance().playSound("click"),WXApi.shareAppMessage()},this)},e}(BaseScene);__reflect(OverScene.prototype,"OverScene");var Scene_000=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=SpriteUtil.createText("你是怎么来到这个关卡的\n真是难以置信");t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY,this.addChild(t)},e}(BaseScene);__reflect(Scene_000.prototype,"Scene_000");var Scene_001=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.selectedArr=[];var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight/8,13487553);t.x=SpriteUtil.stageWidth/2,t.y=SpriteUtil.stageHeight-t.height/2,t.touchEnabled=!0,this.bounds={width:SpriteUtil.stageWidth-60,height:SpriteUtil.stageHeight-SpriteUtil.stageHeight/8-60};for(var e=0;e<this.dataVo.sData.length;e++)this.createText(this.dataVo.sData.charAt(e));this.addChild(t),this.tarText=new egret.TextField,this.tarText.name="target_text",this.tarText.textAlign="center",this.tarText.text="",this.tarText.size=36,this.tarText.textColor=16316671,this.tarText.stroke=1,this.tarText.strokeColor=16776960,this.tarText.bold=!0,this.tarText.width=SpriteUtil.stageWidth,this.tarText.y=t.y-30,this.addChild(this.tarText),this.tarText.touchEnabled=!0,this.tarText.addEventListener(egret.TouchEvent.TOUCH_TAP,this.textClk,this),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.textClk=function(t){var e=this;if(!(this.timeItem.leftTime<=0)){var i=t.target;if(GameSound.instance().playSound("click"),this.tarText==i){i=this.selectedArr.pop();var r=200+320*Math.random(),a=SpriteUtil.stageHeight/2-100,s=this.tarText.text;this.tarText.text=s.substr(0,s.length-1),egret.Tween.get(i).to({x:r,y:a},500,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(i),e.back(i)})}else i.touchEnabled=!1,this.tarText.touchEnabled=!1,egret.Tween.removeTweens(i),egret.Tween.get(i).to({x:this.tarText.x+this.tarText.width/2,y:this.tarText.y,rotation:0},500).call(function(){egret.Tween.removeTweens(i);var t=""+e.tarText.text+i.text;if(e.tarText.text=t,i.touchEnabled=!0,e.tarText.touchEnabled=!0,e.selectedArr.push(i),e.dataVo.tData.indexOf(t)>=0){var r=e.timeItem.leftTime;e.timeItem.stop(),r>=30?EffectUtil.showResultEffect(EffectUtil.PERFECT):r>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}})}},e.prototype.createText=function(t){var e=new egret.TextField;e.size=48,e.text=t,e.textColor=16777215*(8*Math.random()+2)/10,e.stroke=.5,e.strokeColor=16776960,e.bold=!0,e.x=this.bounds.width*Math.random(),e.y=this.bounds.height*Math.random(),this.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.textClk,this),this.back(e)},e.prototype.back=function(t){var e=this;egret.Tween.get(t).to({x:this.bounds.width*Math.random(),y:this.bounds.height*Math.random(),rotation:360*Math.random()},5e3+2e3*Math.random()).call(function(){e.back(t)})},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()
},e.prototype.exit=function(){for(;this.numChildren>1;){var e=this.getChildAt(this.numChildren-1);e instanceof egret.TextField&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.textClk,this),egret.Tween.removeTweens(e),this.removeChild(e)}this.timeItem.stop(),t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_001.prototype,"Scene_001");var Scene_002=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this.dataVo.sData,e=t.concat(t),i=e.length,r=Math.round(Math.sqrt(i)),a=Math.round(SpriteUtil.stageWidth-50)/r;e.sort(function(t,e){return Math.random()>.5?1:Math.random()<.5?-1:0}),this.group=new egret.Sprite;for(var s=e.length,n=0;s>n;n++){var o=SpriteUtil.createImage(e[n],!0);o.anchorOffsetX=0,o.anchorOffsetY=0,o.scaleX=a/o.width,o.scaleY=a/o.height,o.name=e[n],o.x=(a+2)*(n%r),o.y=(a+2)*Math.floor(n/r),this.group.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkHandler,this)}this.addChild(this.group),this.group.x=SpriteUtil.stageCenterX-this.group.width/2,this.group.y=200,this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.clkHandler=function(t){if(!(this.timeItem&&this.timeItem.leftTime<=0)&&(GameSound.instance().playSound("click"),this.currentSelect?this.currentSelect==t.target?(this.currentSelect.alpha=1,this.currentSelect=null):this.currentSelect.name==t.target.name?(this.group.removeChild(this.currentSelect),this.group.removeChild(t.target),this.currentSelect=null):(this.currentSelect.alpha=1,this.currentSelect=t.target,this.currentSelect.alpha=.5):(this.currentSelect=t.target,this.currentSelect.alpha=.5),this.group.numChildren<=0)){var e=this.timeItem.leftTime;this.timeItem.stop(),e>=60?EffectUtil.showResultEffect(EffectUtil.PERFECT):e>=30?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){for(t.prototype.exit.call(this);this.numChildren>1;){var e=this.getChildAt(this.numChildren-1);e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clkHandler,this),this.removeChild(e)}},e}(BaseScene);__reflect(Scene_002.prototype,"Scene_002");var Scene_003=function(t){function e(){var e=t.call(this)||this;return e.angleSpeed1=.06,e.angleSpeed2=.06,e.angleSpeed3=.07,e.angleSpeed4=.075,e.isTouching=!1,e.categories=[1,2,4,8,16,32,64,128],e.playerCategory=256,e.isRunning=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.timeItem=new TimeItem(this.dataVo.time),this.timeItem.x=SpriteUtil.stageWidth-250,this.addChild(this.timeItem),this.engine=Matter.Engine.create({enableSleeping:!1},null);var e=this.engine.world;this.runner=Matter.Runner.create(null),this.runner.isFixed=!0;var i=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}});e.gravity.y=0,Matter.Runner.run(this.runner,this.engine),EgretRender.run(i);var r=SpriteUtil.createImage("boy");this.player=Matter.Bodies.rectangle(50,1250,r.width-20,r.height-6,{stiffness:1,collisionFilter:{category:this.playerCategory},render:{sprite:r}});var a=SpriteUtil.createImage("girl");this.girlbdy=Matter.Bodies.circle(SpriteUtil.stageCenterX,a.height/2+60,a.width/2,{stiffness:1,collisionFilter:{category:this.categories[0],mask:this.playerCategory|this.categories[0]},render:{sprite:a}},0),Matter.World.add(e,[this.player,this.girlbdy]),r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){t.isTouching=!0},this),r.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){if(t.isTouching){var i=e.stageX,r=e.stageY;0>i?i=0:i>SpriteUtil.stageWidth&&(i=SpriteUtil.stageWidth),r>SpriteUtil.stageHeight?r=SpriteUtil.stageHeight:0>r&&(r=0),Matter.Body.setPosition(t.player,{x:i,y:r})}},this),r.addEventListener(egret.TouchEvent.TOUCH_END,function(e){t.isTouching=!1},this),1==this.dataVo.level?this.initL1():2==this.dataVo.level?this.initL2():3==this.dataVo.level&&this.initL3(),Matter.Events.on(this.engine,"beforeUpdate",this.beforeUpdateHandle.bind(this)),Matter.Events.on(this.engine,"collisionStart",this.collisionHandle.bind(this))},e.prototype.initL1=function(){var t=this.engine.world,e=this.createEnemy(SpriteUtil.stageCenterX-360,SpriteUtil.stageCenterY,this.categories[1],36);Matter.World.add(this.engine.world,e),this.enemies=[e],Matter.Body.setAngularVelocity(this.enemies[0][0],1.2*this.angleSpeed1);var i=SpriteUtil.createImage("insect"),r=50/i.width;i.scaleX=r,i.scaleY=r;var a=Matter.Bodies.circle(100,200,r*i.width/2,{label:"Body_enemy",friction:0,frictionAir:0,render:{sprite:i}},0),s=SpriteUtil.createImage("insect");s.scaleX=r,s.scaleY=r;var n=Matter.Bodies.circle(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight-200,r*s.width/2,{label:"Body_enemy",friction:0,frictionAir:0,render:{sprite:s}},0);Matter.World.add(t,[a,n]),this.enemies.push(a),this.enemies.push(n),Matter.Body.setVelocity(a,{x:this.dataVo.sData,y:0}),Matter.Body.setVelocity(n,{x:-1*this.dataVo.sData,y:0})},e.prototype.initL2=function(){var t=this,e=this.engine.world,i=function(e){var i=SpriteUtil.createImage("insect"),r=50/i.width;i.scaleX=r,i.scaleY=r;var a=e%2==0?SpriteUtil.stageWidth-250:250,s=Matter.Bodies.circle(a,200+100*e,r*i.width/2,{label:"Body_enemy",friction:0,frictionAir:0,render:{sprite:i}},0),n=e%2==0?-1:1;return Matter.Body.setVelocity(s,{x:n*t.dataVo.sData*10,y:0}),s};this.enemies=[];for(var r=0;8>r;r++)this.enemies.push(i(r));Matter.World.add(e,this.enemies)},e.prototype.initL3=function(){var t=this.engine.world,e=this.createEnemy(0,560,this.categories[1]);Matter.World.add(t,e);var i=this.createEnemy(200,560,this.categories[2]);Matter.World.add(t,i);var r=this.createEnemy(400,560,this.categories[3]);Matter.World.add(t,r);var a=this.createEnemy(580,560,this.categories[4]);Matter.World.add(t,a);var s=this.createEnemy(0,860,this.categories[5],15);Matter.World.add(t,s);var n=this.createEnemy(400,860,this.categories[5],15);Matter.World.add(t,n);var o=this.createEnemy(210,1100,this.categories[5],15);Matter.World.add(t,o);var h=this.createEnemy(160,160,this.categories[5]);Matter.World.add(t,h);var l=this.createEnemy(310,260,this.categories[5]);Matter.World.add(t,l);var c=this.createEnemy(460,160,this.categories[5]);Matter.World.add(t,c),this.enemies=[e,i,r,a,s,n,o,h,l,c];var d=SpriteUtil.createImage("insect"),p=50/d.width;d.scaleX=p,d.scaleY=p;var g=Matter.Bodies.circle(100,360,p*d.width/2,{label:"Body_enemy",friction:0,frictionAir:0,render:{sprite:d}},0),f=SpriteUtil.createImage("insect");f.scaleX=p,f.scaleY=p;var u=Matter.Bodies.circle(SpriteUtil.stageWidth-100,460,p*f.width/2,{label:"Body_enemy",friction:0,frictionAir:0,render:{sprite:f}},0);Matter.World.add(t,[g,u]),this.enemies.push(g),this.enemies.push(u),Matter.Body.setAngularVelocity(this.enemies[0][0],.1),Matter.Body.setAngularVelocity(this.enemies[0][0],this.angleSpeed1),Matter.Body.setAngularVelocity(this.enemies[1][0],-this.angleSpeed1),Matter.Body.setAngularVelocity(this.enemies[2][0],-this.angleSpeed1),Matter.Body.setAngularVelocity(this.enemies[3][0],this.angleSpeed1),Matter.Body.setAngularVelocity(this.enemies[4][0],-this.angleSpeed2),Matter.Body.setAngularVelocity(this.enemies[5][0],this.angleSpeed2),Matter.Body.setAngularVelocity(this.enemies[6][0],-this.angleSpeed3),Matter.Body.setAngularVelocity(this.enemies[7][0],this.angleSpeed4),Matter.Body.setAngularVelocity(this.enemies[8][0],-this.angleSpeed4),Matter.Body.setAngularVelocity(this.enemies[9][0],this.angleSpeed4),Matter.Body.setVelocity(this.enemies[10],{x:this.dataVo.sData,y:0}),Matter.Body.setVelocity(this.enemies[11],{x:-1*this.dataVo.sData,y:0})},e.prototype.beforeUpdateHandle=function(t){if(this.isRunning){var e=this.enemies.length,i=0;(1==this.dataVo.level||3==this.dataVo.level)&&(i=e-2);for(var r=e-1;r>=i;r--)this.enemies[r].position.x<0?Matter.Body.setVelocity(this.enemies[r],{x:this.dataVo.sData,y:0}):this.enemies[r].position.x>SpriteUtil.stageWidth&&Matter.Body.setVelocity(this.enemies[r],{x:-1*this.dataVo.sData,y:0})}},e.prototype.collisionHandle=function(t){for(var e=t.pairs,i=0,r=e;i<r.length;i++){var a=r[i];(a.bodyA==this.player||a.bodyB==this.player)&&("Body_enemy"==a.bodyA.label||"Body_enemy"==a.bodyB.label?(this.isRunning=!1,this.timeItem.stop(),this.player.render.sprite.touchEnabled=!1,Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Sleeping.afterCollisions(e,.01),Matter.Events.off(this.engine,"beforeUpdate",this.beforeUpdateHandle),Matter.Events.off(this.engine,"collisionStart",this.collisionHandle),EffectUtil.showResultEffect()):(a.bodyA==this.girlbdy||a.bodyB==this.girlbdy)&&(this.isRunning=!1,this.player.render.sprite.touchEnabled=!1,Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Sleeping.afterCollisions(e,.01),Matter.Events.off(this.engine,"collisionStart",this.collisionHandle),this.timeItem.leftTime>=30?EffectUtil.showResultEffect(EffectUtil.PERFECT):this.timeItem.leftTime>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD),this.timeItem.stop()))}},e.prototype.createEnemy=function(t,e,i,r){void 0===i&&(i=1),void 0===r&&(r=7);for(var a=10,s=Matter.Composites.stack(t,e,r,1,0,0,function(t,e){return Matter.Bodies.circle(t,e,a,{label:"Body_enemy"},0)}),n=new egret.Sprite,o=2*a/64,h=0;r>h;h++){var l=SpriteUtil.createImage("fireball");l.scaleX=o,l.scaleY=o,l.x=h*a*2,n.addChild(l)}n.anchorOffsetX=n.width/2-a-a/2;var c=Matter.Body.create({parts:s.bodies,friction:0,frictionAir:0,render:{sprite:n},collisionFilter:{category:i,mask:this.playerCategory|i}}),d=Matter.Constraint.create({pointB:{x:c.position.x,y:c.position.y},bodyA:c,stiffness:1,friction:0,length:0});return[c,d]},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){for(Matter.World.remove(this.engine.world,this.engine.world.bodies,0),Matter.World.remove(this.engine.world,this.engine.world.constraints,0),Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Events.off(this.engine,"collisionStart",this.collisionHandle);this.numChildren>1;){var e=this.getChildAt(this.numChildren-1);this.removeChild(e)}t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_003.prototype,"Scene_003");var Scene_004=function(t){function e(){var e=t.call(this)||this;return e.rotateAngle=0,e.targetIndex=0,e.intervalTime=0,e.exchangeTimes=0,e.maxTimes=0,e.isGameStart=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.giftBoxArr=[],this.giftGroup=new egret.Sprite,this.addChild(this.giftGroup);for(var t=this.dataVo.sData[0],e=this.dataVo.sData[1],i=Math.sqrt(e),r=(SpriteUtil.stageWidth-100)/i,a=0;e>a;a++){var s=SpriteUtil.createImage(t),n=r/s.width;s.scaleX=n,s.scaleY=n,s.x=r/2+a%i*(r+10),s.y=r/2+(r+10)*Math.floor(a/i),s.name="giftBag_"+a,this.giftGroup.addChild(s),s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.giftTap,this),this.giftBoxArr.push(s)}this.giftGroup.x=SpriteUtil.stageCenterX-this.giftGroup.width/2,this.giftGroup.y=SpriteUtil.stageCenterY-this.giftGroup.height/2-200,this.rotatePoint=new egret.Point(SpriteUtil.stageCenterX,SpriteUtil.stageCenterY-200),this.startPoint=new egret.Point(SpriteUtil.stageCenterX,100),this.giftDisplay=SpriteUtil.createImage(this.dataVo.tData),this.giftDisplay.scaleX=r/this.giftDisplay.width/1.5,this.giftDisplay.scaleY=r/this.giftDisplay.width/1.5,this.giftDisplay.x=SpriteUtil.stageCenterX,this.giftDisplay.y=50,this.addChild(this.giftDisplay),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),9==e?(this.intervalTime=300,this.maxTimes=25):16==e?(this.intervalTime=200,this.maxTimes=30):(this.intervalTime=180,this.maxTimes=60),this.playDrop()},e.prototype.playDrop=function(){var t=this;egret.Tween.get(this.giftDisplay).to({x:this.giftDisplay.x,y:this.startPoint.y},500).call(function(){egret.startTick(t.loop,t)}).wait(500)},e.prototype.loop=function(t){var e=this;this.rotateAngle+=.1;var i=this.startPoint.x-this.rotatePoint.x,r=this.startPoint.y-this.rotatePoint.y;if(this.giftDisplay.x=i*Math.cos(this.rotateAngle)-r*Math.sin(this.rotateAngle)+this.rotatePoint.x,this.giftDisplay.y=r*Math.cos(this.rotateAngle)-i*Math.sin(this.rotateAngle)+this.rotatePoint.y,this.rotateAngle>2*Math.PI+2*Math.PI*Math.random()){egret.stopTick(this.loop,this);var a=this.giftGroup.localToGlobal(this.giftBoxArr[this.targetIndex].x,this.giftBoxArr[this.targetIndex].y);egret.Tween.get(this.giftDisplay).to({x:a.x,y:a.y},500,egret.Ease.cubicIn).to({alpha:0},1e3).call(function(){egret.Tween.removeTweens(e.giftDisplay),e.giftDisplay.visible=!1,e.randomBox(!0)})}return!1},e.prototype.randomBox=function(t){var e=this;void 0===t&&(t=!1);var i=Math.random()<.2||t?this.targetIndex:Math.floor(this.giftBoxArr.length*Math.random()),r=Math.floor(this.giftBoxArr.length*Math.random());if(i==r)return void this.randomBox();if(this.exchangeTimes++,this.exchangeTimes>=this.maxTimes)return this.isGameStart=!0,void this.timeItem.start();var a=this.giftBoxArr[i],s=this.giftBoxArr[r],n=new egret.Point(a.x,a.y),o=new egret.Point(s.x,s.y);egret.Tween.get(a).to({x:o.x,y:o.y},this.intervalTime),egret.Tween.get(s).to({x:n.x,y:n.y},this.intervalTime).call(function(){var t=egret.setTimeout(function(){egret.clearTimeout(t),e.randomBox()},e,50)})},e.prototype.giftTap=function(t){var e=this;if(this.isGameStart){GameSound.instance().playSound("click");var i=t.target.name;if(!(i.search("giftBag")<0)){this.isGameStart=!1;var r=t.target.name.split("_")[1],a=this.giftGroup.localToGlobal(this.giftBoxArr[this.targetIndex].x,this.giftBoxArr[this.targetIndex].y);if(this.giftDisplay.x=a.x,this.giftDisplay.y=a.y,this.giftDisplay.alpha=0,this.giftDisplay.visible=!0,r==this.targetIndex){var s=this.timeItem.leftTime;this.timeItem.stop(),egret.Tween.get(this.giftDisplay).to({alpha:1},300).call(function(){egret.Tween.removeTweens(e.giftDisplay),s>=10?EffectUtil.showResultEffect(EffectUtil.PERFECT):s>=5?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)})}else this.timeItem.stop(),egret.Tween.get(this.giftDisplay).to({alpha:1},300).call(function(){egret.Tween.removeTweens(e.giftDisplay),EffectUtil.showResultEffect()})}}},e.prototype.enter=function(){t.prototype.enter.call(this),this.targetIndex=Math.floor(this.giftBoxArr.length*Math.random()),this.playDrop()},e.prototype.exit=function(){egret.Tween.removeAllTweens(),t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_004.prototype,"Scene_004");var Scene_005=function(t){function e(){var e=t.call(this)||this;return e.itemCategory=2,e.playerCategory=256,e.score=0,e.isTouching=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.engine=Matter.Engine.create({enableSleeping:!1},null),this.runner=Matter.Runner.create(null),this.render=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}}),Matter.Runner.run(this.runner,this.engine),EgretRender.run(this.render),this.engine.world.gravity.y=0,this.recycleArr=[],this.initAllItem();var e=SpriteUtil.createImage(this.dataVo.extData),i=100/e.width;e.scaleX=i,e.scaleY=i,this.player=Matter.Bodies.circle(SpriteUtil.stageCenterX,SpriteUtil.stageCenterY,i*(e.height-10)/2,{isStatic:!0,collisionFilter:{category:this.playerCategory},render:{sprite:e}},0),Matter.World.add(this.engine.world,this.player),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.isTouching=!0},this),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){t.isTouching&&Matter.Body.setPosition(t.player,{x:e.stageX,y:e.stageY})},this),e.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.isTouching=!1},this),Matter.Events.on(this.engine,"beforeUpdate",this.beforeUpdate.bind(this)),Matter.Events.on(this.engine,"collisionStart",this.collisionStart.bind(this));var r=egret.setInterval(function(){t.playAttack()||egret.clearInterval(r)},this,500);this.scoreItem=new ScoreItem,this.scoreItem.setSTScore(0,this.dataVo.score),this.scoreItem.x=50,this.addChild(this.scoreItem)},e.prototype.initAllItem=function(){this.recycleArr=[],this.fruitArr=[];for(var t=this.dataVo.sData,e=this.dataVo.tData,i=t.length,r=e.length,a=0,s=this.dataVo.time,n=Math.ceil(s/4),o=Math.ceil(s/2),h=Math.ceil(3*s/4),l=0;s>l;l++){var c=0,d=0;n>l?(c=-50,d=l%n*(SpriteUtil.stageHeight/n)):o>l?(c=(l-n)%o*(SpriteUtil.stageWidth/o),d=SpriteUtil.stageHeight+50):h>l?(c=SpriteUtil.stageWidth+50,d=(l-o)%h*(SpriteUtil.stageHeight/h)):(c=(l-h)%h*(SpriteUtil.stageWidth/h),d=-50);var p=void 0;Math.random()>.5?(a=Math.floor(i*Math.random()),p=this.createItem(t[a],"fruit",c,d)):(a=Math.floor(r*Math.random()),p=this.createItem(e[a],"enemy",c,d)),this.fruitArr.push(p)}Matter.World.add(this.engine.world,this.fruitArr)},e.prototype.beforeUpdate=function(){this.recycleArr&&0!=this.recycleArr.length&&this.removeBody()},e.prototype.collisionStart=function(t){for(var e=t.pairs,i=0,r=e;i<r.length;i++){var a=r[i];a.bodyA==this.player?"fruit"==a.bodyB.name?(this.removeBody(a.bodyB),this.score++,this.scoreItem.setSTScore(this.score),this.scoreItem.isCanPass()&&(this.destroy(),EffectUtil.showResultEffect(EffectUtil.PERFECT))):"enemy"==a.bodyB.name&&(this.destroy(),EffectUtil.showResultEffect()):a.bodyB==this.player&&("fruit"==a.bodyA.name?(this.removeBody(a.bodyA),this.score++,this.scoreItem.setSTScore(this.score),this.scoreItem.isCanPass()&&(this.destroy(),EffectUtil.showResultEffect(EffectUtil.PERFECT))):"enemy"==a.bodyA.name&&(this.destroy(),EffectUtil.showResultEffect()))}},e.prototype.removeBody=function(t){if(void 0===t&&(t=null),t){var e=this.recycleArr.indexOf(t);e>=0&&(this.recycleArr.splice(e,1),Matter.World.remove(this.engine.world,t,0),this.removeChild(t.render.sprite))}else for(var i=this.recycleArr.length,r=i-1;r>=0;r--){var a=this.recycleArr[r];(a.position.x<-100||a.position.x>SpriteUtil.stageWidth+100||a.position.y<-100||a.position.y>SpriteUtil.stageHeight+100)&&(Matter.World.remove(this.engine.world,a,0),this.recycleArr.splice(r,1),this.removeChild(a.render.sprite))}},e.prototype.playAttack=function(){var t=this.fruitArr.length;if(0>=t)return 0==this.recycleArr.length?(this.destroy(),this.scoreItem.isCanPass()?(this.destroy(),EffectUtil.showResultEffect(EffectUtil.PERFECT)):EffectUtil.showResultEffect(),!1):!0;var e=Math.floor(t*Math.random()),i=this.fruitArr.splice(e,1)[0];this.recycleArr.push(i);var r=this.player.position.x-i.position.x,a=this.player.position.y-i.position.y,s=a/r;s>10&&(s=10),-10>s&&(s=-10);var n=2.5*r/Math.abs(r),o=2.5*n*s;return n=Math.abs(n)>4?4*n/Math.abs(n):n,o=Math.abs(o)>5?5*o/Math.abs(o):o,Matter.Body.setVelocity(i,{x:n,y:o}),Matter.Body.setAngularVelocity(i,.01*n),!0},e.prototype.createItem=function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var a=SpriteUtil.createImage(t),s=Matter.Bodies.circle(i,r,(a.height-20)/2,{name:e,frictionAir:0,collisionFilter:{category:this.itemCategory,mask:1|this.playerCategory},render:{sprite:a}},0);return s},e.prototype.destroy=function(){Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Events.off(this.engine,"beforeUpdate",this.beforeUpdate),Matter.Events.off(this.engine,"collisionStart",this.collisionStart),Matter.World.remove(this.engine.world,this.engine.world.bodies,0),Matter.World.remove(this.engine.world,this.engine.world.constraints,0)},e.prototype.exit=function(){for(this.destroy();this.numChildren>1;){var e=this.getChildAt(this.numChildren-1);this.removeChild(e)}t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_005.prototype,"Scene_005");var Scene_006=function(t){function e(){var e=t.call(this)||this;return e.isOperating=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timeItem=new TimeItem(30),this.addChild(this.timeItem);var t=this.dataVo.sData;this.tarSprite=this.createPic(t),this.tarSprite.x=SpriteUtil.stageCenterX-this.tarSprite.width/2,this.tarSprite.y=SpriteUtil.stageCenterY-this.tarSprite.height/2-100,this.tarSprite.name="target_1",this.addChild(this.tarSprite),this.picSprs=[],this.createRandomPic(t,2,3),this.createRandomPic(t,3,4),this.createRandomPic(t,2,4),this.createRandomPic(t,3,5),this.createRandomPic(t,5,6),this.createRandomPic(t,4,7),this.createRandomPic(t,5,8),this.createRandomPic(t,6,7);var e=this.dataVo.tData;12==e&&(this.createRandomPic(t,3,8),this.createRandomPic(t,7,9),this.createRandomPic(t,5,11))},e.prototype.startGame=function(){this.picSprs.push(this.tarSprite),this.tarSprite.touchEnabled=!0,this.tarSprite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectClk,this),this.picSprs.sort(function(t,e){return Math.random()>.5?1:-1});for(var t=(this.dataVo.tData,3),e=(SpriteUtil.stageWidth-100)/(this.tarSprite.width*t),i=e*this.tarSprite.width,r=e*this.tarSprite.height,a=new egret.Sprite,s=0;s<this.picSprs.length;s++){var n=s%t*(i+10),o=(r+5)*Math.floor(s/t);this.picSprs[s].x=n,this.picSprs[s].y=o,a.addChild(this.picSprs[s]),this.picSprs[s].scaleX=e,this.picSprs[s].scaleY=e}this.addChild(a),a.x=SpriteUtil.stageCenterX-a.width/2,a.y=SpriteUtil.stageCenterY-a.height/2},e.prototype.createRandomPic=function(t,e,i){void 0===t&&(t=[]),void 0===e&&(e=0),void 0===i&&(i=0);var r=t.concat(),a=r[e];r[e]=r[i],r[i]=a;var s=this.createPic(r);s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectClk,this),s.name="mistake",s.touchEnabled=!0,this.picSprs.push(s)},e.prototype.selectClk=function(t){if(!this.isOperating){this.isOperating=!0,GameSound.instance().playSound("click");var e=t.target.name;if("mistake"==e)return this.timeItem.stop(),void EffectUtil.showResultEffect();if(e&&!(e.search("target_")<0)){var i=(parseInt(e.split("_")[1]),t.target);i.touchEnabled=!1,i.parent.setChildIndex(i,i.parent.numChildren-1);var r=this.timeItem.leftTime;this.timeItem.stop(),egret.Tween.get(i).to({x:SpriteUtil.stageCenterX-.5*i.width/2,y:200,scaleX:.5,scaleY:.5},800).call(function(){r>=30?EffectUtil.showResultEffect(EffectUtil.PERFECT):r>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)})}}},e.prototype.createPic=function(t){for(var e=t.length,i=3,r=(SpriteUtil.stageWidth-120)/i,a=new egret.Sprite,s=0;e>s;s++){var n=SpriteUtil.createImage(t[s]),o=r/n.width;n.scaleX=o,n.scaleY=o,n.x=10+r/2+s%i*(r+10),n.y=10+r/2+(r+10)*Math.floor(s/i),n.touchEnabled=!1,a.addChild(n)}return a.graphics.beginFill(7368816),a.graphics.drawRect(0,0,a.width+20,a.height+20),a.graphics.endFill(),a},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start(this.loop,this)},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop();for(var e=0,i=this.picSprs;e<i.length;e++){var r=i[e];r.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectClk,this)}},e.prototype.loop=function(t){0>=t&&(this.startGame(),this.timeItem.stop(),this.timeItem.restart(this.dataVo.time))},e}(BaseScene);__reflect(Scene_006.prototype,"Scene_006");var Scene_007=function(t){function e(){var e=t.call(this)||this;return e.needNums=0,e.score=0,e.isOperating=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.scoreItem=new ScoreItem,this.scoreItem.x=50,this.scoreItem.setSTScore(this.score,this.dataVo.score),this.addChild(this.scoreItem),this.timeItem.x=SpriteUtil.stageWidth-300,this.needNums=1,this.pointsArr=[];for(var t=0;40>t;t++){var e=new egret.Point;e.x=90+140*(t%5),e.y=120+100*Math.floor(t/5),this.pointsArr.push(e)}},e.prototype.loop=function(t){if(0>=t)if(this.isOperating=!0,this.timeItem.stop(),this.scoreItem.isCanPass()){var e=this.score-this.dataVo.score;e>=10?EffectUtil.showResultEffect(EffectUtil.PERFECT):e>=5?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else EffectUtil.showResultEffect();else 8>=t?this.needNums=30:10>=t?this.needNums=20:20>=t?this.needNums=15:25>=t?this.needNums=10:this.needNums=5},e.prototype.showSprites=function(t){var e=this,i=0,r=Math.floor(t*Math.random()),a=this.getRandomPoints(t),s=egret.setInterval(function(){if(e.isOperating)return void egret.clearInterval(s);var n=Math.floor(e.dataVo.sData.length*Math.random());i==r&&(n=0);var o=e.getPools(n);if(o.x=e.pointsArr[a[i]].x,o.y=e.pointsArr[a[i]].y,i++,i>=t){egret.clearInterval(s);var h=egret.setTimeout(function(){if(egret.clearTimeout(h),!e.isOperating){for(var t=0,i=e.pools;t<i.length;t++){var r=i[t];r.visible=!1}e.showSprites(e.needNums)}},e,1e3)}},this,100)},e.prototype.getRandomPoints=function(t){for(var e=[];e.length<t;){var i=Math.floor(40*Math.random());e.indexOf(i)<0&&e.push(i)}return e},e.prototype.getPools=function(t){var e=this;void 0===t&&(t=0);var i,r=this.dataVo.sData[t];if(this.pools)for(var a=0,s=this.pools;a<s.length;a++){var n=s[a];if(!n.visible){i=n;break}}else this.pools=[];if(i)i.texture=RES.getRes("images_json#"+r),i.visible=!0;else{i=SpriteUtil.createImage(r),this.pools.push(i);var o=100/i.width;i.scaleX=o,i.scaleY=o,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(!e.isOperating){GameSound.instance().playSound("click");var i=t.target;i.name==e.dataVo.tData?(i.visible=!1,e.score++,e.scoreItem.setSTScore(e.score)):(e.timeItem.stop(),e.isOperating=!0,EffectUtil.showResultEffect())}},this)}return i.touchEnabled=!0,i.name=r,this.addChild(i),i},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start(this.loop,this),this.showSprites(this.needNums)},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop()},e}(BaseScene);__reflect(Scene_007.prototype,"Scene_007");var Scene_008=function(t){function e(){var e=t.call(this)||this;return e.animalsArr=CommonUtil.allAnimals.concat(),e.needCount=0,e.isOperating=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.listSpr=new egret.Sprite,this.listSpr.x=100,this.listSpr.y=250,this.listSpr.visible=!1,this.addChild(this.listSpr);for(var t=0;t<this.animalsArr.length;t++){var e=SpriteUtil.createImage(this.animalsArr[t]);e.x=t%5*125,e.y=125*Math.floor(t/5),e.touchEnabled=!0,e.name=this.animalsArr[t],e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectClk,this),this.listSpr.addChild(e)}this.animalsArr.sort(function(t,e){return Math.random()>.5?1:Math.random()<.5?-1:0}),this.passArr=[],this.animalSpr=SpriteUtil.createImage(this.animalsArr[this.needCount]),this.animalSpr.y=SpriteUtil.stageCenterY-100,this.animalSpr.scaleX=3,this.animalSpr.scaleY=3,this.addChild(this.animalSpr),this.emojiSpr=SpriteUtil.createImage("emoji01"),this.emojiSpr.scaleX=4,this.emojiSpr.scaleY=4,this.emojiSpr.visible=!1,this.addChild(this.emojiSpr),EffectUtil.breath(this.emojiSpr),this.playShow()},e.prototype.playShow=function(){var t=this,e=this.animalsArr[this.needCount],i=this.dataVo.sData[Math.floor(this.dataVo.sData.length*Math.random())];this.passArr.push({animal:e,emoji:i}),this.animalSpr.texture=RES.getRes("images_json#"+e),this.animalSpr.name=e;var r=this.getRandomPos();this.animalSpr.x=r[0],this.animalSpr.y=r[1],this.animalSpr.visible=!0,egret.Tween.get(this.animalSpr).to({x:SpriteUtil.stageCenterX,y:SpriteUtil.stageCenterY},500).call(function(){var e=egret.setTimeout(function(){egret.clearTimeout(e),egret.Tween.removeTweens(t.animalSpr),t.emojiSpr.x=t.animalSpr.x,t.emojiSpr.y=t.animalSpr.y,t.emojiSpr.texture=RES.getRes("images_json#"+i),t.emojiSpr.visible=!0;var r=egret.setTimeout(function(){return egret.clearTimeout(r),t.emojiSpr.visible=!1,t.animalSpr.visible=!1,t.needCount++,t.needCount>=t.dataVo.tData?void t.startLook():void t.playShow()},t,1500)},t,1e3)})},e.prototype.getRandomPos=function(){var t=[[0,0],[SpriteUtil.stageCenterX,0],[SpriteUtil.stageWidth,0],[0,SpriteUtil.stageCenterY],[SpriteUtil.stageWidth,SpriteUtil.stageCenterY],[0,SpriteUtil.stageHeight],[SpriteUtil.stageCenterX,SpriteUtil.stageHeight],[SpriteUtil.stageWidth,SpriteUtil.stageHeight]],e=Math.floor(t.length*Math.random());return t[e]},e.prototype.startLook=function(){egret.Tween.removeAllTweens(),this.removeChild(this.animalSpr),this.removeChild(this.emojiSpr),this.dataVo.tData=this.passArr[Math.floor(this.passArr.length*Math.random())].emoji;var t=SpriteUtil.createImage(this.dataVo.tData),e="谜题:找出所有发出表情       的动物",i=SpriteUtil.createText(e,36,16316671);i.x=SpriteUtil.stageCenterX,i.y=150,t.x=i.x+i.measuredWidth-i.width/2-4*i.measuredWidth/15,t.y=i.y,this.addChild(t),this.addChild(i),this.listSpr.visible=!0,this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.timeItem.start()},e.prototype.selectClk=function(t){if(!this.isOperating){GameSound.instance().playSound("click");for(var e=t.target,i=!1,r=this.passArr.length,a=r-1;a>=0;a--){var s=this.passArr[a];s.emoji==this.dataVo.tData&&s.animal==e.name&&(e.alpha=.5,e.touchEnabled=!1,i=!0,this.passArr.splice(a,1))}i?this.isCanPass()&&(this.timeItem.leftTime>=25?EffectUtil.showResultEffect(EffectUtil.PERFECT):this.timeItem.leftTime>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD),this.timeItem.stop()):(this.isOperating=!0,EffectUtil.showResultEffect())}},e.prototype.isCanPass=function(){for(var t=0,e=this.passArr;t<e.length;t++){var i=e[t];if(i.emoji==this.dataVo.tData)return!1}return!0},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop(),egret.Tween.removeAllTweens()},e}(BaseScene);__reflect(Scene_008.prototype,"Scene_008");var Scene_009=function(t){function e(){var e=t.call(this)||this;return e.isTouching=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.engine=Matter.Engine.create({enableSleeping:!1},null),this.runner=Matter.Runner.create(null),this.render=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}}),Matter.Runner.run(this.runner,this.engine),EgretRender.run(this.render),this.engine.world.gravity.y=1,this.createWall(),this.createBall();var t=SpriteUtil.createRect(200,10,16711680),e=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,450,t.width,t.height,{frictionAir:.05,friction:0,render:{sprite:t}}),i=Matter.Constraint.create({bodyA:e,pointB:{x:e.position.x,y:e.position.y},stiffness:1});Matter.World.add(this.engine.world,[e,i]),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Matter.Body.setAngularVelocity(e,0);var t=0==e.angle?Math.PI/2:0;Matter.Body.setAngle(e,t)},this),this.createVc(60,500,0),this.createVc(SpriteUtil.stageWidth-100,500,0);var r=SpriteUtil.createRect(200,10,255),a=Matter.Bodies.rectangle(80,SpriteUtil.stageCenterY,200,10,{isStatic:!0,angle:Math.PI/4,friction:1,render:{sprite:r}}),s=SpriteUtil.createRect(200,10,255),n=Matter.Bodies.rectangle(SpriteUtil.stageWidth-80,SpriteUtil.stageCenterY,200,10,{isStatic:!0,angle:-Math.PI/4,friction:1,render:{sprite:s}}),o=SpriteUtil.createRect(200,10,255),h=Matter.Bodies.rectangle(80,250,200,10,{isStatic:!0,angle:Math.PI/4,friction:1,render:{sprite:o}}),l=SpriteUtil.createRect(200,10,255),c=Matter.Bodies.rectangle(SpriteUtil.stageWidth-80,250,200,10,{isStatic:!0,angle:-Math.PI/4,friction:1,render:{sprite:l}});Matter.World.add(this.engine.world,[a,n,h,c]),Matter.Events.on(this.engine,"collisionActive",this.collision.bind(this)),this.createCatapult(),this.createBoard()},e.prototype.collision=function(t){for(var e=t.pairs,i=0,r=0,a=0,s=50,n=0,o=e;n<o.length;n++){var h=o[n],l="basketBoard"==h.bodyA.label?h.bodyA:null,c=h.bodyB;null==l&&(l="basketBoard"==h.bodyB.label?h.bodyB:null,c=h.bodyA),null!=l&&(c.mass==s/2?r++:c.mass==2*s?i++:c.mass==s&&a++)}if(r+i>=2){Matter.Events.off(this.engine,"collisionActive",this.collision),Matter.Runner.stop(this.runner),EgretRender.stop();var d=this.timeItem.leftTime;this.timeItem.stop(),d>=30?EffectUtil.showResultEffect(EffectUtil.PERFECT):d>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)
}else r+i==1&&1==a?(Matter.Events.off(this.engine,"collisionActive",this.collision),Matter.Runner.stop(this.runner),this.timeItem.stop(),EgretRender.stop(),EffectUtil.showResultEffect()):2==a&&(Matter.Events.off(this.engine,"collisionActive",this.collision),Matter.Runner.stop(this.runner),EgretRender.stop(),this.timeItem.stop(),EffectUtil.showResultEffect())},e.prototype.touchBegin=function(t){var e=t.target.name;if(e&&-1!=e.search("ball_")){var i=e.split("_")[1];this.currDragBall=this.ballsArr[i],this.isTouching=!0}},e.prototype.touchMove=function(t){this.isTouching&&this.currDragBall&&(Matter.Body.setVelocity(this.currDragBall,{x:0,y:-1}),Matter.Sleeping.set(this.currDragBall,!1),Matter.Body.setPosition(this.currDragBall,{x:t.stageX,y:t.stageY}))},e.prototype.touchEnd=function(){this.isTouching=!1,Matter.Body.setVelocity(this.currDragBall,{x:0,y:0}),this.currDragBall=null},e.prototype.createBall=function(){var t=this;this.ballsArr=[];var e=0,i=this.dataVo.sData,r=CommonUtil.getRandomNumFromARange(2,0,i);r.sort(function(t,e){return t-e});var a="basketball";3==this.dataVo.level&&(a="football");var s=50,n=egret.setInterval(function(){var o=SpriteUtil.createImage(a),h=60/o.width;o.scaleX=h,o.scaleY=h;var l=(SpriteUtil.stageWidth-100)*Math.random();1!=t.dataVo.level&&e<t.dataVo.sData-2&&(l=e%2==0?20:SpriteUtil.stageWidth-20);var c=s;1==t.dataVo.level?(c=r[0]==e?2*s:s,c!=2*s&&(c=r[1]==e?2*s:s)):2==t.dataVo.level?(c=r[0]==e?s/2:s,c!=s/2&&(c=r[1]==e?s/2:s)):3==t.dataVo.level&&(c=r[0]==e?2*s:s,c!=2*s&&(c=r[1]==e?s/2:s)),o.name="ball_"+e;var d=Matter.Bodies.circle(l,0,h*o.height/2,{restitution:.5,friction:1,label:"ball",render:{sprite:o}},0);Matter.World.add(t.engine.world,d),Matter.Body.setMass(d,c),t.ballsArr.push(d),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBegin,t),o.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),o.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEnd,t),o.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.touchEnd,t),o.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.touchEnd,t),e++,e>=i&&egret.clearInterval(n)},this,500);Matter.World.add(this.engine.world,this.ballsArr)},e.prototype.createVc=function(t,e,i){void 0===i&&(i=65280);var r=SpriteUtil.createRect(50,10,i),a=Matter.Bodies.rectangle(t,e,50,10,{isStatic:!0,angle:Math.PI/3,render:{sprite:r}}),s=SpriteUtil.createRect(50,10,i),n=Matter.Bodies.rectangle(t+40,e,50,10,{isStatic:!0,angle:-Math.PI/3,render:{sprite:s}}),o=SpriteUtil.createRect(30,10,i),h=Matter.Bodies.rectangle(t+20,e,30,10,{isStatic:!0,label:"basketBoard",render:{sprite:o}}),l=new egret.TextField;l.text="实验结果",l.x=t+20,l.y=e-60,l.textAlign="center",l.textColor=255,l.size=22,l.width=100,l.anchorOffsetX=50,this.addChild(l),Matter.World.add(this.engine.world,[a,n,h])},e.prototype.createWall=function(){var t=Matter.Bodies.rectangle(-5,SpriteUtil.stageCenterY,10,SpriteUtil.stageHeight,{isStatic:!0}),e=Matter.Bodies.rectangle(SpriteUtil.stageWidth+5,SpriteUtil.stageCenterY,10,SpriteUtil.stageHeight,{isStatic:!0}),i=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,-5,SpriteUtil.stageWidth,10,{isStatic:!0}),r=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageHeight-100,SpriteUtil.stageWidth,250,{isStatic:!0});Matter.World.add(this.engine.world,[t,e,i,r])},e.prototype.createBoard=function(){for(var t=[],e=0;6>e;e++){var i=SpriteUtil.createRect(10,50,Math.ceil(16776960*Math.random())+32),r=Matter.Bodies.rectangle(10+100*(e+1),SpriteUtil.stageCenterY+200,10,50,{isStatic:!0,render:{sprite:i}});t.push(r)}Matter.World.add(this.engine.world,t)},e.prototype.createCatapult=function(){var t=SpriteUtil.createRect(200,16,13435085),e=Matter.Bodies.rectangle(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight-290,t.width,t.height,{render:{sprite:t}}),i=SpriteUtil.createRect(20,40,16711935),r=Matter.Bodies.rectangle(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight-270,i.width,i.height,{isStatic:!0,render:{sprite:i}}),a=SpriteUtil.createRect(30,30,986895),s=Matter.Bodies.rectangle(SpriteUtil.stageWidth-15,SpriteUtil.stageHeight-266,a.width,a.height,{isStatic:!0,render:{sprite:a}}),n=Matter.Constraint.create({bodyA:e,pointB:Matter.Vector.clone(e.position),stiffness:1,length:0});Matter.World.add(this.engine.world,[r,s,e,n])},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop();for(var e=0,i=this.engine.world.bodies;e<i.length;e++){var r=i[e];"ball"==r.label&&(r.render.sprite.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),r.render.sprite.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),r.render.sprite.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),r.render.sprite.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEnd,this),r.render.sprite.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEnd,this))}Matter.World.remove(this.engine.world,this.engine.world.bodies,0),Matter.World.remove(this.engine.world,this.engine.world.constraints,0)},e}(BaseScene);__reflect(Scene_009.prototype,"Scene_009");var Scene_010=function(t){function e(){var e=t.call(this)||this;return e.items=[],e.curIndex=0,e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=GameData.getConfig("scene"+this.dataVo.levelType);this.items=t.items,this.questionTxt=new egret.TextField,this.questionTxt.size=30,this.questionTxt.width=SpriteUtil.stageWidth-120,this.questionTxt.textColor=15597806,this.questionTxt.stroke=2,this.questionTxt.strokeColor=16777215,this.questionTxt.bold=!0,this.questionTxt.lineSpacing=20,this.questionTxt.textAlign="left",this.questionTxt.verticalAlign="middle",this.questionTxt.anchorOffsetX=this.questionTxt.width/2,this.questionTxt.anchorOffsetY=this.questionTxt.height/2,this.questionTxt.x=SpriteUtil.stageCenterX,this.questionTxt.y=120,this.questionTxt.text="麻烦透露下您的性别",this.addChild(this.questionTxt),this.btnsArr=[];for(var e=new egret.Sprite,i=0;10>i;i++){var r=this.createText("");r.x=280*(i%2),r.y=80*Math.floor(i/2),e.addChild(r),this.btnsArr.push(r),r.name="btn_"+i,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkSwitch,this)}e.x=SpriteUtil.stageCenterX-e.width/2,e.y=480,this.addChild(e),this.optionSpr=e,this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.clkSwitch=function(t){var e=this;if(this.isCanOperate){if(this.curIndex>=this.items.length-1)return void Game.instance().gameScene.enterMenu();var i=t.target,r=i.name;if(r&&!(r.search("btn_")<0)){var a=r.split("_")[1],s=this.items[this.curIndex].answer;this.isCanOperate=!1,a==s?EffectUtil.showTextAndBack("✓",function(){e.curIndex++,e.nextItem(),e.isCanOperate=!0}):(this.timeItem.stop(),EffectUtil.showResultEffect())}}},e.prototype.nextItem=function(){var t=this.items[this.curIndex],e=t.options;this.questionTxt.text="☛ "+t.question;for(var i=this.btnsArr.length,r=0;i>r;r++)e[r]?(this.btnsArr[r].text=e[r],this.btnsArr[r].visible=!0):this.btnsArr[r].visible=!1;this.optionSpr.y=this.questionTxt.y+this.questionTxt.height+40},e.prototype.createText=function(t){void 0===t&&(t="");var e=new egret.TextField;return e.size=32,e.text=t,e.textColor=5577355,e.textAlign="center",e.verticalAlign="middle",e.width=200,e.height=60,e.bold=!0,e.background=!0,e.backgroundColor=58862,e},e.prototype.enter=function(){t.prototype.enter.call(this),this.nextItem(),this.timeItem.start()},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop()},e}(BaseScene);__reflect(Scene_010.prototype,"Scene_010");var Scene_011=function(t){function e(){var e=t.call(this)||this;return e.isOperating=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem);for(var t=new egret.Sprite,e=this.dataVo.sData[0],i=this.dataVo.sData[1],r=Math.floor((i-10)*Math.random()+10),a=0;i>a;a++){var s=void 0;a==r?(s=this.createText(this.dataVo.tData),this.tarTxt=s):s=this.createText(e),s.x=a%10*66,s.y=66*Math.floor(a/10),t.addChild(s)}t.anchorOffsetX=t.width/2,t.x=SpriteUtil.stageCenterX,t.y=100,this.addChild(t)},e.prototype.textClk=function(t){if(!this.isOperating){GameSound.instance().playSound("click"),this.isOperating=!0;var e=t.target.text;if(e==this.dataVo.tData){var i=this.timeItem.leftTime;this.timeItem.stop(),i>=25?EffectUtil.showResultEffect(EffectUtil.PERFECT):i>=15?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.timeItem.stop(),this.tarTxt.textColor=16711680,EffectUtil.showResultEffect()}},e.prototype.createText=function(t){var e=new egret.TextField;return e.size=54,e.text=t,e.textColor=8388564,e.stroke=.5,e.strokeColor=13479168,e.bold=!0,this.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.textClk,this),e},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_011.prototype,"Scene_011");var Game=function(){function t(){}return t.instance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.setStage=function(e){this._gameStage=e,SpriteUtil.stageWidth=e.stageWidth,SpriteUtil.stageHeight=e.stageHeight,SpriteUtil.stageCenterX=e.stageWidth/2,SpriteUtil.stageCenterY=e.stageHeight/2,this._bottom=new egret.DisplayObjectContainer,this._middle=new egret.DisplayObjectContainer,this._top=new egret.DisplayObjectContainer,this._gameStage.addChild(this._bottom),this._gameStage.addChild(this._middle),this._gameStage.addChild(this._top),this._gameScene=new GameScene,this._gameView=new GameView,GameData.isWxGame?t.instance().gameScene.enterMenu():this._gameScene.enterMenu()},t.prototype.addBottom=function(t){this._bottom.addChild(t)},t.prototype.addMiddle=function(t){this._middle.addChild(t)},t.prototype.addTop=function(t){this._top.addChild(t)},Object.defineProperty(t.prototype,"gameStage",{get:function(){return this._gameStage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gameScene",{get:function(){return this._gameScene},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gameView",{get:function(){return this._gameView},enumerable:!0,configurable:!0}),t._instance=null,t}();__reflect(Game.prototype,"Game");var Scene_013=function(t){function e(){var e=t.call(this)||this;return e.leftIndex=0,e.rightIndex=0,e.xScale=3.2,e.isOperating=!1,e.score=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){for(var t=["赢","和","赢"],e=t.length,i=(SpriteUtil.stageWidth-100)/e,r=new egret.Sprite,a=0;e>a;a++){var s=SpriteUtil.createText(t[a],100,16711680,!0),n=i/s.width;s.x=a*(i+10)+n*s.width/2,s.scaleX=n,s.scaleY=n,this.addChild(s),s.name="index_"+a,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playDoing,this),r.addChild(s)}this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=SpriteUtil.stageCenterX,r.y=SpriteUtil.stageCenterY+280,this.leftSpr=SpriteUtil.createImage(this.dataVo.sData[0]),this.leftSpr.scaleY=this.xScale,this.leftSpr.x=SpriteUtil.stageCenterX-160,this.leftSpr.y=SpriteUtil.stageCenterY-160,this.addChild(this.leftSpr),this.rightSpr=SpriteUtil.createImage(this.dataVo.sData[0]),this.rightSpr.scaleY=this.xScale,this.rightSpr.x=SpriteUtil.stageCenterX+160,this.rightSpr.y=SpriteUtil.stageCenterY-160,this.addChild(this.rightSpr),this.enemyDoing(),this.dataVo.time>0&&(this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)),this.dataVo.score>0&&(this.scoreItem=new ScoreItem,this.scoreItem.setSTScore(0,this.dataVo.score),this.scoreItem.x=50,this.addChild(this.scoreItem),this.timeItem.x=SpriteUtil.stageWidth-300)},e.prototype.enemyDoing=function(){var t=this.dataVo.sData.length;this.leftIndex=Math.floor(t*Math.random()),this.leftSpr.texture=RES.getRes("images_json#"+this.dataVo.sData[this.leftIndex]),this.rightIndex=Math.floor(t*Math.random()),this.rightSpr.texture=RES.getRes("images_json#"+this.dataVo.sData[this.rightIndex]),this.dataVo.level<=2?(2==this.leftIndex?this.leftSpr.scaleX=this.xScale:this.leftSpr.scaleX=-this.xScale,2==this.rightIndex?this.rightSpr.scaleX=-this.xScale:this.rightSpr.scaleX=this.xScale):this.dataVo.level<=4?(2==this.leftIndex?this.leftSpr.scaleX=-this.xScale:this.leftSpr.scaleX=this.xScale,1==this.rightIndex||3==this.rightIndex?this.rightSpr.scaleX=-this.xScale:this.rightSpr.scaleX=this.xScale):(this.leftSpr.scaleX=this.xScale,this.rightSpr.scaleX=this.xScale)},e.prototype.playDoing=function(t){if(!this.isOperating){GameSound.instance().playSound("click");var e=t.target.name,i=e.split("_")[1];i==this.getResult()?(this.enemyDoing(),this.score++,this.scoreItem.setSTScore(this.score)):(this.timeItem.stop(),this.isOperating=!0,EffectUtil.showResultEffect())}},e.prototype.getResult=function(){var t=this.dataVo.sData.length,e=0;if(5==this.dataVo.level){var i=this.leftIndex-this.rightIndex;return 2==i||-3==i?e=2:-1==i||3==i||(e=1),e}return e=this.leftIndex==t-1?this.rightIndex==this.leftIndex-1?2:0==this.rightIndex?0:1:this.rightIndex==t-1?this.leftIndex==this.rightIndex-1?0:0==this.leftIndex?2:1:this.leftIndex-this.rightIndex==1?2:this.leftIndex-this.rightIndex==-1?0:1},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start(this.resultBack,this)},e.prototype.resultBack=function(t){0>=t&&(this.isOperating=!0,this.timeItem.stop(),this.score>=this.dataVo.score+10?EffectUtil.showResultEffect(EffectUtil.PERFECT):this.score>=this.dataVo.score+5?EffectUtil.showResultEffect(EffectUtil.GREAT):this.score>=this.dataVo.score?EffectUtil.showResultEffect(EffectUtil.GOOD):EffectUtil.showResultEffect())},e}(BaseScene);__reflect(Scene_013.prototype,"Scene_013");var Scene_014=function(t){function e(){var e=t.call(this)||this;return e.currTarget=null,e.isOperating=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.cropPoints=[],this.cropPics=[],this.createFruit()},e.prototype.createFruit=function(){var t=this.dataVo.sData,e=t.length;this.beforeContainer=new egret.Sprite,this.addChild(this.beforeContainer);for(var i=0;e>i;i++){var r=25+225*(i%3),a=150+225*Math.floor(i/3),s=SpriteUtil.createImage(t[i]);s.anchorOffsetX=0,s.anchorOffsetY=0,s.width=200,s.height=200,s.x=r,s.y=a,s.name=t[i],s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectPic,this),this.beforeContainer.addChild(s)}this.titleTxt=SpriteUtil.createText(this.dataVo.tData,32,16316671),this.titleTxt.x=SpriteUtil.stageCenterX,this.titleTxt.y=100,this.addChild(this.titleTxt)},e.prototype.selectPic=function(t){GameSound.instance().playSound("click");var e=t.target.name;this.createSeparate("images_json#"+e),this.beforeContainer.visible=!1,this.removeChild(this.beforeContainer),this.titleTxt.text="来吧！还原这个图像！",this.titleTxt.anchorOffsetX=this.titleTxt.width/2,this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.timeItem.start()},e.prototype.createSeparate=function(t){this.picContainer=new egret.Sprite;var e=new egret.Shape;e.graphics.beginFill(15),e.graphics.drawRect(0,0,660,660),e.graphics.endFill(),this.picContainer.addChild(e),this.picContainer.x=30,this.picContainer.y=200,this.addChild(this.picContainer);var i=new egret.Bitmap(RES.getRes(t));i.width=640,i.height=640;for(var r=[],a=0;16>a;a++){r.push(a);var s=2+165*(a%4),n=2+165*Math.floor(a/4);this.cropPoints.push({x:s,y:n});var o=new egret.RenderTexture;o.drawToTexture(i,new egret.Rectangle(160*(a%4),160*Math.floor(a/4),160,160));var h=new egret.Bitmap;h.texture=o,h.x=s,h.y=n,h.sIndex=a,h.tIndex=a,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkCrop,this),this.picContainer.addChild(h),this.cropPics.push(h)}r.sort(function(t,e){return Math.random()>.5?1:-1});for(var a=0;a<r.length;a++){var l=r[a];this.cropPics[a].tIndex=l,this.cropPics[a].x=this.cropPoints[l].x,this.cropPics[a].y=this.cropPoints[l].y}},e.prototype.clkCrop=function(t){var e=this;if(!(this.isOperating||this.timeItem.leftTime<=0)){GameSound.instance().playSound("click");var i=t.target;if(null==this.currTarget)this.currTarget=i,i.alpha=.5;else if(this.currTarget==i)this.currTarget=null,i.alpha=1;else{var r=i.tIndex,a=this.currTarget.tIndex;i.tIndex=a,this.currTarget.tIndex=r,i.alpha=1,this.currTarget.alpha=1,egret.Tween.get(this.currTarget).to({x:this.cropPoints[r].x,y:this.cropPoints[r].y},200).call(function(){egret.Tween.removeTweens(e.currTarget),e.currTarget=null}),egret.Tween.get(i).to({x:this.cropPoints[a].x,y:this.cropPoints[a].y},200).call(function(){egret.Tween.removeTweens(i),e.checkOver()})}}},e.prototype.checkOver=function(){if(this.isCanPass()){var t=this.timeItem.leftTime;this.timeItem.stop(),t>=90?EffectUtil.showResultEffect(EffectUtil.PERFECT):t>=60?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}},e.prototype.isCanPass=function(){for(var t=0,e=this.cropPics;t<e.length;t++){var i=e[t];if(i.sIndex!=i.tIndex)return!1}return!0},e}(BaseScene);__reflect(Scene_014.prototype,"Scene_014");var Scene_015=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){for(var t=this.dataVo.sData[0],e=this.dataVo.sData[1],i=Math.round(Math.sqrt(e)),r=Math.round(SpriteUtil.stageWidth-120)/i,a=new egret.Sprite,s=Math.floor(parseInt(e)*Math.random()),n=0;e>n;n++){var o=void 0;n==s?(o=this.createShape(this.dataVo.tData,r),o.name=this.dataVo.tData):(o=this.createShape(t,r),o.name=t),o.x=n%i*(r+5),o.y=Math.floor(n/i)*(r+5),a.addChild(o),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkShape,this)}a.x=SpriteUtil.stageCenterX-a.width/2,a.y=120,this.addChild(a),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.clkShape=function(t){if(!(this.timeItem.leftTime<=0)){GameSound.instance().playSound("click");var e=t.target.name;if(e==this.dataVo.tData){var i=this.timeItem.leftTime;this.timeItem.stop(),i>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):i>=this.dataVo.time/2?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.timeItem.stop(),EffectUtil.showResultEffect()}},e.prototype.createShape=function(t,e,i){void 0===i&&(i=0);var r=new egret.Shape;return r.graphics.beginFill(t),r.graphics.drawRect(0,0,e,e),r.graphics.endFill(),r},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_015.prototype,"Scene_015");var Scene_016=function(t){function e(){var e=t.call(this)||this;return e.isCanOperate=!0,e.score=0,e.intervalId=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,e=new egret.Shape;e.graphics.beginFill(65280,.01),e.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),e.graphics.endFill(),this.addChild(e),this.engine=Matter.Engine.create({enableSleeping:!1},null),this.runner=Matter.Runner.create(null),this.runner.isFixed=!0;var i=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}});Matter.Runner.run(this.runner,this.engine),EgretRender.run(i),this.engine.world.gravity.y=1;var r=SpriteUtil.createImage(this.dataVo.sData),a=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,500,r.width-20,r.height-20,{label:"bird",render:{sprite:r}});this.birdBody=a,Matter.World.add(this.engine.world,a),Matter.Events.on(this.engine,"collisionStart",this.collisionStart.bind(this)),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapMakeBirdFly,this),this.intervalId=egret.setInterval(function(){t.createAWall()},this,this.dataVo.time),this.beforeUpdateFun=function(){if(t.birdBody.position.y>=SpriteUtil.stageHeight)return t.birdBody.isStatic=!0,t.destroy(),void t.checkResult();if(t.isCanOperate&&t.wallArr&&0!=t.wallArr.length)for(var e=0,i=t.wallArr;e<i.length;e++){var r=i[e],a=r.body1,s=r.body2,n=a.position.x;n-=t.dataVo.tData,Matter.Body.setPosition(a,{x:n,y:a.position.y}),Matter.Body.setPosition(s,{x:n,y:s.position.y})}},Matter.Events.on(this.engine,"beforeUpdate",this.beforeUpdateFun),this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.scoreItem.setSTScore(this.score,this.dataVo.score),this.createAWall()},e.prototype.collisionStart=function(t){for(var e=t.pairs,i=0,r=e;i<r.length;i++){var a=r[i];("bird"==a.bodyA.label||"bird"==a.bodyB.label)&&(this.isCanOperate=!1,this.checkResult())}},e.prototype.tapMakeBirdFly=function(t){this.isCanOperate&&(GameSound.instance().playSound("click"),Matter.Body.setVelocity(this.birdBody,{x:0,y:-8}))},e.prototype.createAWall=function(){this.wallArr||(this.wallArr=[]);for(var t=(this.score%2==0?!0:!1,SpriteUtil.stageWidth+200),e=this.wallArr.length,i=e-1;i>=0;i--){var r=this.wallArr[i].body1,a=this.wallArr[i].body2;r.position.x<=-r.render.sprite.width&&(Matter.World.remove(this.engine.world,[r,a],0),this.removeChild(r.render.sprite),this.removeChild(a.render.sprite),this.wallArr.splice(i,1),this.score++,this.scoreItem.setSTScore(this.score))}var s=80+120*Math.random(),n=SpriteUtil.createRect(s,550,16777215*Math.random()),o=Matter.Bodies.rectangle(t,75+200*Math.random(),n.width,n.height,{label:"wall",isStatic:!0,render:{sprite:n}}),h=SpriteUtil.createRect(s,550,16777215*Math.random()),l=Matter.Bodies.rectangle(t,SpriteUtil.stageHeight-75-200*Math.random(),h.width,h.height,{label:"wall",isStatic:!0,render:{sprite:h}});this.wallArr.push({body1:o,body2:l}),Matter.World.add(this.engine.world,[o,l])},e.prototype.checkResult=function(){if(this.birdBody.isStatic=!0,this.destroy(),this.scoreItem.isCanPass()){var t=this.score-this.dataVo.score;t>=15?EffectUtil.showResultEffect(EffectUtil.PERFECT):t>=10?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else EffectUtil.showResultEffect()},e.prototype.destroy=function(){this.isCanOperate=!1,egret.clearInterval(this.intervalId),Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Events.off(this.engine,"collisionStart",this.collisionStart),Matter.Events.off(this.engine,"beforeUpdate",this.beforeUpdateFun),Matter.World.remove(this.engine.world,this.engine.world.bodies,0)},e.prototype.exit=function(){this.destroy(),t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_016.prototype,"Scene_016");var Scene_017=function(t){function e(){var e=t.call(this)||this;return e.isCanOperate=!0,e.loseCnt=0,e.usedCnt=0,e.intervalId=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,e=new egret.Shape;e.graphics.beginFill(65280,.01),e.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),e.graphics.endFill(),this.addChild(e),this.boxArr=[],this.engine=Matter.Engine.create({enableSleeping:!0},null),this.runner=Matter.Runner.create(null),this.runner.isFixed=!0;var i=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}});Matter.Runner.run(this.runner,this.engine),EgretRender.run(i),this.engine.world.gravity.y=1;var r=SpriteUtil.createImage(this.dataVo.sData);r.x=r.width/2,r.y=120,this.addChild(r),this.skyBox=r;var a="以热爱祖国为荣  以危害祖国为耻\n以服务人民为荣  以背离人民为耻\n以崇尚科学为荣  以愚昧无知为耻\n以辛勤劳动为荣  以好逸恶劳为耻\n以团结互助为荣  以损人利己为耻\n以诚实守信为荣  以见利忘义为耻\n以遵纪守法为荣  以违法乱纪为耻\n以艰苦奋斗为荣  以骄奢淫逸为耻",s=SpriteUtil.createText(a,30,16711680,!0),n=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageHeight-s.height/2,s.width,s.height,{isStatic:!0,friction:5,frictionStatic:5,render:{sprite:s}});Matter.World.add(this.engine.world,n),this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.refreshCnt(),this.timeItem=new TimeItem(300),this.addChild(this.timeItem),this.timeItem.x=SpriteUtil.stageWidth-300,egret.Tween.get(this.skyBox,{loop:!0}).to({x:SpriteUtil.stageWidth-this.skyBox.width/2},this.dataVo.time).to({x:this.skyBox.width/2},this.dataVo.time),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapAddBox,this),this.intervalId=egret.setInterval(function(){for(var e=t.boxArr.length,i=0;e>i;i++){var r=t.boxArr[i];r.position.y>SpriteUtil.stageHeight+2*r.render.sprite.width&&!r.isStatic&&(t.loseCnt++,Matter.Body.setStatic(r,!0),Matter.Body.setPosition(r,{x:-(200+800*Math.random()),y:r.position.y}))}t.checkResult()},this,100)},e.prototype.tapAddBox=function(t){var e=this;if(this.isCanOperate){if(GameSound.instance().playSound("click"),this.usedCnt++,this.isCanOperate=!1,this.usedCnt>this.dataVo.score)return void EffectUtil.showResultEffect();GameSound.instance().playSound("click");var i=egret.setTimeout(function(){egret.clearTimeout(i),e.isCanOperate=!0},this,500);this.refreshCnt(),this.createBox()}},e.prototype.createBox=function(){for(var t=this.skyBox.x,e=this.skyBox.y,i=this.boxArr.length,r=0;i>r;r++){var a=this.boxArr[r];if(a.position.y>SpriteUtil.stageHeight+a.render.sprite.width/2&&a.position.x<-200)return Matter.Body.setStatic(a,!1),Matter.Body.setAngle(a,0),Matter.Body.setAngularVelocity(a,0),Matter.Body.setVelocity(a,{x:0,y:0}),Matter.Body.setPosition(a,{x:t,y:e}),Matter.Body.set(a,"restitution",0),Matter.Body.set(a,"friction",1),void Matter.Body.set(a,"isSleeping",!1)}var s=SpriteUtil.createImage(this.dataVo.sData),n=Matter.Bodies.rectangle(t,e,s.width,s.height,{frictionAir:.005,friction:.5,mass:10,render:{sprite:s}});Matter.World.add(this.engine.world,n),this.boxArr.push(n)},e.prototype.checkResult=function(){if(this.refreshCnt(),!(this.usedCnt<this.dataVo.tData)){for(var t=0,e=0,i=this.boxArr;e<i.length;e++){var r=i[e];!r.isStatic&&r.position.y<=SpriteUtil.stageHeight-80&&r.isSleeping&&t++}if(t>=this.dataVo.tData){this.isCanOperate=!1;var a=this.timeItem.leftTime;this.destroy(),a>=90?EffectUtil.showResultEffect(EffectUtil.PERFECT):a>=150?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else{var s=this.dataVo.score-this.usedCnt;s+this.usedCnt-this.loseCnt<this.dataVo.tData&&(this.isCanOperate=!1,this.destroy(),EffectUtil.showResultEffect())}}},e.prototype.refreshCnt=function(){var t="剩余 "+(this.dataVo.score-this.usedCnt)+"  目标 "+this.dataVo.tData;this.scoreItem.setCustomText(t)},e.prototype.destroy=function(){this.timeItem.stop(),egret.clearInterval(this.intervalId),egret.Tween.removeTweens(this.skyBox),this.isCanOperate=!1,Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.World.remove(this.engine.world,this.engine.world.bodies,0)},e.prototype.enter=function(){var e=this;t.prototype.enter.call(this),this.timeItem.start(function(t){0>t&&(e.destroy(),e.timeItem.stop(),EffectUtil.showResultEffect())},this)},e.prototype.exit=function(){this.destroy(),t.prototype.exit.call(this)},e}(BaseScene);__reflect(Scene_017.prototype,"Scene_017");var Scene_018=function(t){function e(){var e=t.call(this)||this;return e.knifeArr=[],e.hadKnifesArr=[],e.rotateAngle=.6,e.currCount=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.rotateAngle=this.dataVo.tData,this.currCount=this.dataVo.sData;for(var t=this.dataVo.sData,e=0;t>e;e++){var i=this.createKnifes();this.knifeArr.push({sprite:i,angle:0})}this.rotatePoint=new egret.Point(SpriteUtil.stageCenterX,400),this.startPoint=new egret.Point(SpriteUtil.stageCenterX,640);var r=SpriteUtil.createImage("earth");r.x=this.rotatePoint.x,r.y=this.rotatePoint.y,r.scaleX=5.625,r.scaleY=5.625,this.addChild(r),this.dartSprite=r,this.createLeftTxt(),this.showNext(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),egret.startTick(this.loop,this)},e.prototype.loop=function(t){void 0===t&&(t=0),this.dartSprite.rotation+=this.rotateAngle;for(var e=0,i=this.hadKnifesArr;e<i.length;e++){var r=i[e];r.sprite.rotation+=this.rotateAngle;var a=r.sprite.rotation*Math.PI/180,s=this.startPoint.x-this.rotatePoint.x,n=this.startPoint.y-this.rotatePoint.y,o=s*Math.cos(a)-n*Math.sin(a)+this.rotatePoint.x,h=n*Math.cos(a)-s*Math.sin(a)+this.rotatePoint.y;r.sprite.x=o,r.sprite.y=h}return!0},e.prototype.fireKnife=function(t){var e=this;GameSound.instance().playSound("click"),this.curKnife.sprite.touchEnabled=!1,egret.Tween.get(this.curKnife.sprite).to({y:this.startPoint.y},200,egret.Ease.cubicIn).call(function(){egret.Tween.removeTweens(e.curKnife.sprite);for(var t=e.dartSprite.rotation%360,i=0,r=e.hadKnifesArr;i<r.length;i++){var a=r[i];if(Math.abs(a.angle-t)<=12)return void egret.Tween.get(e.curKnife.sprite).to({y:SpriteUtil.stageHeight,rotation:360*(2*Math.random()+2)},3e3).call(function(){egret.Tween.removeTweens(e.curKnife),e.leftKnifesTxt.text="",e.timeItem.stop(),EffectUtil.showResultEffect()})}e.curKnife.angle=t,e.hadKnifesArr.push(e.curKnife),e.showNext()},this)},e.prototype.showNext=function(){if(this.currCount<=0){this.leftKnifesTxt.text="";var t=this.timeItem.leftTime;this.timeItem.stop(),t>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):t>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.curKnife=this.knifeArr.pop(),this.addChildAt(this.curKnife.sprite,0),this.leftKnifesTxt.text="x"+this.currCount,this.currCount--},e.prototype.createLeftTxt=function(){this.leftKnifesTxt=new egret.TextField,this.leftKnifesTxt.size=48,this.leftKnifesTxt.bold=!0,this.leftKnifesTxt.textColor=255,this.leftKnifesTxt.x=SpriteUtil.stageCenterX+50,this.leftKnifesTxt.y=SpriteUtil.stageCenterY+270,this.addChild(this.leftKnifesTxt)},e.prototype.createKnifes=function(){var t=SpriteUtil.createImage("tree");return t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY+300,t.scaleX=.8,t.scaleY=-1,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fireKnife,this),t},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){t.prototype.exit.call(this),this.timeItem.stop(),egret.stopTick(this.loop,this)},e}(BaseScene);__reflect(Scene_018.prototype,"Scene_018");var Scene_019=function(t){function e(){var e=t.call(this)||this;return e.allBoxDataArr=[],e.curSelectIndex=-1,e.isCanOperate=!0,e.stepNums=0,e.ROWS=10,e.COLUMNS=8,e.init(),e}return __extends(e,t),e.prototype.init=function(){for(var t=this,e=[],i=new egret.Sprite,r=0;r<this.COLUMNS*this.ROWS;r++){var a=SpriteUtil.createImage("box");a.anchorOffsetX=0,a.anchorOffsetY=0,a.touchEnabled=!1;var s=new egret.Shape;s.graphics.lineStyle(2,255,1),s.graphics.moveTo(0,0),s.graphics.lineTo(a.width,0),s.graphics.lineTo(a.width,a.height),s.graphics.lineTo(0,a.height),s.graphics.lineTo(0,0),s.visible=!1;var n=new egret.Sprite;n.name=this.dataVo.sData[0]+"_"+r,n.x=(a.width+2)*(r%this.COLUMNS),n.y=(a.width+2)*Math.floor(r/this.COLUMNS),n.addChild(a),n.addChild(s),i.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapExchange,this),e.push({index:r,box:n})}i.x=SpriteUtil.stageCenterX-i.width/2,i.y=200,this.addChild(i),this.allBoxDataArr=e;var o=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight-i.height-i.y,0);o.anchorOffsetX=0,o.anchorOffsetY=0,o.y=i.y+i.height,this.addChild(o);var h=SpriteUtil.createButton("重置",160,80,255,36);h.x=SpriteUtil.stageCenterX-h.width/2,h.y=200,this.addChild(h),h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.isCanOperate&&t.createList()},this),this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.createList(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.createList=function(){for(var t=0,e=this.allBoxDataArr;t<e.length;t++){var i=e[t];i.box.visible=!1}for(var r=0;r<this.dataVo.sData.length;r++){var a=this.dataVo.sData[r],s=this.allBoxDataArr[a.index].box;s.getChildAt(0).texture=RES.getRes("images_json#"+a.box),s.visible=!0,s.name=a.box+"_"+a.index}this.stepNums=this.dataVo.tData,this.scoreItem.setCustomText("剩余步数  "+this.stepNums)},e.prototype.tapExchange=function(t){if(this.isCanOperate&&!(this.timeItem.leftTime<=0)){GameSound.instance().playSound("click");var e=t.target,i=e.name.split("_")[1];if(e.getChildAt(1).visible=!0,-1==this.curSelectIndex)return void(this.curSelectIndex=i);
if(this.curSelectIndex!=i)if(this.isNextTo(this.curSelectIndex,i))this.isCanOperate=!1,this.stepNums--,this.scoreItem.setCustomText("剩余步数  "+this.stepNums),this.exchangeBox(this.curSelectIndex,i),this.refreshPos([this.curSelectIndex,i]);else{var r=this.allBoxDataArr[this.curSelectIndex].box;r.getChildAt(1).visible=!1,this.curSelectIndex=i}}},e.prototype.checkResult=function(t){for(var e=[],i=0;i<t.length;i++){var r=this.getClearRowNums(t[i]),a=this.getClearColNums(t[i]);r.length>=3&&(e=e.concat(r)),a.length>=3&&(e=e.concat(a))}if(0!=e.length){for(var s=0,n=e;s<n.length;s++){var o=n[s];this.allBoxDataArr[o].box.visible=!1}this.refreshAll(e)}else if(this.isCanPass()){var h=this.timeItem.leftTime;this.timeItem.stop(),h>=1*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):h>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.stepNums<=0?(this.isCanOperate=!1,EffectUtil.showResultEffect(),this.timeItem.stop()):(this.isCanOperate=!0,this.curSelectIndex=-1)},e.prototype.getClearRowNums=function(t){for(var e=Math.floor(t/this.COLUMNS),i=t%this.COLUMNS,r=this.allBoxDataArr[t].box,a=r.name.split("_")[0],s=[],n=i;n>=0;n--){var o=n+e*this.COLUMNS,h=this.allBoxDataArr[o].box;if(h.name.split("_")[0]!=a||!h.visible)break;s.push(o)}for(var n=i+1;n<this.COLUMNS;n++){var o=n+e*this.COLUMNS,l=this.allBoxDataArr[o].box;if(l.name.split("_")[0]!=a||!l.visible)break;s.push(o)}return s},e.prototype.getClearColNums=function(t){for(var e=Math.floor(t/this.COLUMNS),i=t%this.COLUMNS,r=this.allBoxDataArr[t].box,a=r.name.split("_")[0],s=[],n=e;n>=0;n--){var o=n*this.COLUMNS+i,h=this.allBoxDataArr[o].box;if(h.name.split("_")[0]!=a||!h.visible)break;s.push(o)}for(var n=e+1;10>n;n++){var o=n*this.COLUMNS+i,l=this.allBoxDataArr[o].box;if(l.name.split("_")[0]!=a||!l.visible)break;s.push(o)}return s},e.prototype.isNextTo=function(t,e){return 1==Math.abs(t-e)?!0:Math.abs(t-e)==this.COLUMNS?!0:!1},e.prototype.isCanPass=function(){for(var t=0,e=this.allBoxDataArr;t<e.length;t++){var i=e[t];if(i.box.visible)return!1}return!0},e.prototype.exchangeBox=function(t,e){var i=this.allBoxDataArr[t].index;this.allBoxDataArr[t].index=this.allBoxDataArr[e].index,this.allBoxDataArr[e].index=i;var r=this.allBoxDataArr[t];this.allBoxDataArr[t]=this.allBoxDataArr[e],this.allBoxDataArr[e]=r},e.prototype.refreshPos=function(t){for(var e=this,i=function(i){var a=r.allBoxDataArr[t[i]].box,s=r.allBoxDataArr[t[i]].index,n=a.name;a.name=n.split("_")[0]+"_"+s,a.getChildAt(1).visible=!1,egret.Tween.get(a).to({x:(a.getChildAt(0).width+2)*(s%r.COLUMNS),y:(a.getChildAt(0).width+2)*Math.floor(s/r.COLUMNS)},250).call(function(){if(egret.Tween.removeTweens(a),i==t.length-1)var r=egret.setTimeout(function(){egret.clearTimeout(r),e.checkResult(t)},e,500)},r)},r=this,a=0;a<t.length;a++)i(a)},e.prototype.refreshAll=function(t){for(var e=this,i=this.allBoxDataArr.length,r=i-1;r>=0;r--){var a=this.allBoxDataArr[r].box;if(!a.visible)for(var s=Math.floor(r/this.COLUMNS),n=r%this.COLUMNS,o=s-1;o>=0;o--)if(this.allBoxDataArr[o*this.COLUMNS+n].box.visible){this.exchangeBox(o*this.COLUMNS+n,r),t.push(o*this.COLUMNS+n);break}}i=this.allBoxDataArr.length;for(var h=function(i){var r=l.allBoxDataArr[i].box,a=l.allBoxDataArr[i].index,s=r.name;r.name=s.split("_")[0]+"_"+a,egret.Tween.get(r).to({x:(r.getChildAt(0).width+2)*(a%l.COLUMNS),y:(r.getChildAt(0).width+2)*Math.floor(a/l.COLUMNS)},250).call(function(){if(egret.Tween.removeTweens(r),0==i&&t.length>0)var a=egret.setTimeout(function(){egret.clearTimeout(a),e.checkResult(t)},e,300)},l)},l=this,r=i-1;r>=0;r--)h(r)},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_019.prototype,"Scene_019");var Scene_020=function(t){function e(){var e=t.call(this)||this;return e.roadAllArr=[],e.leftIndex=0,e.rightIndex=0,e.ownIndex=0,e.diceArr=[],e.isRunning=!1,e.intervalId=0,e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Sprite;this.addChild(t),this.container=t;var e=new egret.Shape;e.graphics.beginFill(0,.1),e.graphics.lineStyle(30,9140069),e.graphics.drawRect(0,0,250,250),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=SpriteUtil.stageCenterX+15,e.y=SpriteUtil.stageCenterY-100,this.container.addChild(e);var i=this.createLeftCastle();i.x=115,i.y=SpriteUtil.stageCenterY-110,this.container.addChild(i);var r=this.createRightCastle();r.x=SpriteUtil.stageCenterX+130,r.y=i.y,this.container.addChild(r);var a=this.createMiddleCastle();a.x=SpriteUtil.stageCenterX,a.y=i.y+120,this.container.addChild(a);var s=SpriteUtil.createText(this.dataVo.sData[4],60,65280,!0);s.x=e.x-e.width/2,s.y=e.y-e.height/2,this.container.addChild(s);var n=SpriteUtil.createText(this.dataVo.sData[5],60,65280,!0);n.x=e.x-15,n.y=e.y-e.height/2,this.container.addChild(n);var o=SpriteUtil.createText(this.dataVo.sData[6],60,65280,!0);o.x=e.x+e.width/2-30,o.y=e.y-e.height/2,this.container.addChild(o);var h=SpriteUtil.createText(this.dataVo.sData[7],60,65280,!0);h.x=e.x+e.width/2-30,h.y=e.y+e.height/2-30,this.container.addChild(h);var l=SpriteUtil.createText(this.dataVo.sData[8],60,65280,!0);l.x=e.x-e.width/2,l.y=e.y+e.height/2-30,this.container.addChild(l);var c=SpriteUtil.createText(this.dataVo.sData[9],60,65280,!0);c.x=e.x-15,c.y=e.y-10,this.container.addChild(c);var d=SpriteUtil.createText(this.dataVo.sData[10],60,65280,!0);d.x=e.x-15,d.y=SpriteUtil.stageCenterY-e.height/2-200,this.container.addChild(d);var p=SpriteUtil.createText(this.dataVo.sData[11],60,65280,!0);p.x=e.x-15,p.y=SpriteUtil.stageCenterY-e.height/2-300,this.container.addChild(p);var g=SpriteUtil.createImage("pyramid");g.x=SpriteUtil.stageCenterX,g.y=SpriteUtil.stageCenterY-e.height/2-400,this.container.addChild(g);var f=SpriteUtil.createRect(30,400,268267520);f.anchorOffsetY=0,f.x=e.x-15,f.y=g.y+20,this.container.addChildAt(f,1),this.roadAllArr[0]=this.storagePoint(i),this.roadAllArr[1]=this.storagePoint(a),this.roadAllArr[2]=this.storagePoint(r),this.roadAllArr[0]=this.roadAllArr[0].concat([{x:l.x,y:l.y},{x:h.x,y:h.y},{x:o.x,y:o.y},{x:n.x,y:n.y},{x:s.x,y:s.y}]),this.roadAllArr[1]=this.roadAllArr[1].concat([{x:h.x,y:h.y},{x:o.x,y:o.y},{x:n.x,y:n.y},{x:s.x,y:s.y},{x:l.x,y:l.y}]),this.roadAllArr[2]=this.roadAllArr[2].concat([{x:o.x,y:o.y},{x:n.x,y:n.y},{x:s.x,y:s.y},{x:l.x,y:l.y},{x:h.x,y:h.y}]);for(var u=0;3>u;u++)this.roadAllArr[u]=this.roadAllArr[u].concat([{x:c.x,y:c.y},{x:d.x,y:d.y},{x:p.x,y:p.y},{x:g.x,y:g.y}]);this.leftPlayer=SpriteUtil.createImage("emoji11"),this.leftPlayer.x=this.roadAllArr[0][0].x,this.leftPlayer.y=this.roadAllArr[0][0].y,this.container.addChild(this.leftPlayer),EffectUtil.breath(this.leftPlayer,.2),this.ownPlayer=SpriteUtil.createImage("emoji16"),this.ownPlayer.x=this.roadAllArr[1][0].x,this.ownPlayer.y=this.roadAllArr[1][0].y,this.container.addChild(this.ownPlayer),EffectUtil.breath(this.ownPlayer,.2),this.rightPlayer=SpriteUtil.createImage("emoji19"),this.rightPlayer.x=this.roadAllArr[2][0].x,this.rightPlayer.y=this.roadAllArr[2][0].y,this.container.addChild(this.rightPlayer),EffectUtil.breath(this.rightPlayer,.2);var m=SpriteUtil.createImage("dice1");m.x=SpriteUtil.stageCenterX-100,m.y=SpriteUtil.stageCenterY+500,this.container.addChild(m);var v=SpriteUtil.createImage("dice2");v.x=SpriteUtil.stageCenterX,v.y=SpriteUtil.stageCenterY+500,this.container.addChild(v);var S=SpriteUtil.createImage("dice3");S.x=SpriteUtil.stageCenterX+100,S.y=SpriteUtil.stageCenterY+500,this.container.addChild(S),this.container.scaleX=.8,this.container.scaleY=.8,this.container.x=.2*this.container.width/2,this.diceArr=[m,v,S],m.addEventListener(egret.TouchEvent.TOUCH_TAP,this.diceTap,this),v.addEventListener(egret.TouchEvent.TOUCH_TAP,this.diceTap,this),S.addEventListener(egret.TouchEvent.TOUCH_TAP,this.diceTap,this)},e.prototype.diceTap=function(){if(this.isCanOperate)if(this.isRunning=!this.isRunning,this.isRunning)this.startDices();else{egret.clearInterval(this.intervalId),this.isCanOperate=!1;for(var t=0,e=0,i=this.diceArr;e<i.length;e++){var r=i[e];t+=parseInt(r.name)}t%3==1?(this.leftIndex++,this.movePlayer(0,this.leftIndex)):t%3==2?(this.ownIndex++,this.movePlayer(1,this.ownIndex)):t%3==0&&(this.rightIndex++,this.movePlayer(2,this.rightIndex))}},e.prototype.startDices=function(){var t=this;this.intervalId=egret.setInterval(function(){for(var e=0,i=t.diceArr;e<i.length;e++){var r=i[e],a=Math.ceil(6*Math.random());r.texture=RES.getRes("images_json#dice"+a),r.name=""+a}},this,40)},e.prototype.movePlayer=function(t,e){var i,r=this;0==t?i=this.leftPlayer:1==t?i=this.ownPlayer:2==t&&(i=this.rightPlayer);var a=egret.Tween.get(i);a.wait(500),a.to({x:this.roadAllArr[t][e].x,y:this.roadAllArr[t][e].y},500).call(function(){r.isCanOperate=!0,r.checkResult()},this)},e.prototype.checkResult=function(){this.leftIndex>=this.roadAllArr[0].length-1||this.rightIndex>=this.roadAllArr[2].length-1?(this.isCanOperate=!1,EffectUtil.showResultEffect()):this.ownIndex>=this.roadAllArr[1].length-1&&(EffectUtil.showResultEffect(EffectUtil.PERFECT),this.isCanOperate=!1)},e.prototype.createLeftCastle=function(){var t=new egret.Sprite,e=SpriteUtil.createImage("house");e.y=300,t.addChild(e);var i=SpriteUtil.createText(this.dataVo.sData[0],60,65280,!0);i.y=200,t.addChild(i);var r=SpriteUtil.createText(this.dataVo.sData[1],60,65280,!0);r.y=100,t.addChild(r);var a=SpriteUtil.createText(this.dataVo.sData[2],60,65280,!0);t.addChild(a);var s=SpriteUtil.createText(this.dataVo.sData[3],60,65280,!0);s.x=120,t.addChild(s);var n=SpriteUtil.createRect(30,e.y,9140069);n.anchorOffsetY=0,t.addChildAt(n,0);var o=SpriteUtil.createRect(s.x,30,9140069);return o.anchorOffsetX=0,t.addChildAt(o,0),t},e.prototype.createRightCastle=function(){var t=new egret.Sprite,e=120,i=SpriteUtil.createImage("house");i.x=e,i.y=300,t.addChild(i);var r=SpriteUtil.createText(this.dataVo.sData[0],60,65280,!0);r.x=e,r.y=200,t.addChild(r);var a=SpriteUtil.createText(this.dataVo.sData[1],60,65280,!0);a.x=e,a.y=100,t.addChild(a);var s=SpriteUtil.createText(this.dataVo.sData[2],60,65280,!0);s.x=e,t.addChild(s);var n=SpriteUtil.createText(this.dataVo.sData[3],60,65280,!0);t.addChild(n);var o=SpriteUtil.createRect(30,i.y,9140069);o.anchorOffsetY=0,o.x=e,t.addChildAt(o,0);var h=SpriteUtil.createRect(e,30,9140069);return h.anchorOffsetX=0,t.addChildAt(h,0),t},e.prototype.createMiddleCastle=function(){var t=new egret.Sprite,e=SpriteUtil.createImage("house");e.y=400,t.addChild(e);var i=SpriteUtil.createText(this.dataVo.sData[0],60,65280,!0);i.y=300,t.addChild(i);var r=SpriteUtil.createText(this.dataVo.sData[1],60,65280,!0);r.y=200,t.addChild(r);var a=SpriteUtil.createText(this.dataVo.sData[2],60,65280,!0);a.y=100,t.addChild(a);var s=SpriteUtil.createText(this.dataVo.sData[3],60,65280,!0);t.addChild(s);var n=SpriteUtil.createRect(30,e.y,9140069);return n.anchorOffsetY=0,t.addChildAt(n,0),t},e.prototype.storagePoint=function(t){for(var e=[],i=t.numChildren-1,r=0;5>r;i--,r++){var a=t.getChildAt(i),s=t.localToGlobal(a.x,a.y);e.push({x:s.x,y:s.y})}return e.reverse(),e},e.prototype.exit=function(){t.prototype.exit.call(this);for(var e=0,i=this.diceArr;e<i.length;e++){var r=i[e];egret.Tween.removeTweens(r)}egret.Tween.removeTweens(this.leftPlayer),egret.Tween.removeTweens(this.ownPlayer),egret.Tween.removeTweens(this.rightPlayer),egret.clearInterval(this.intervalId)},e}(BaseScene);__reflect(Scene_020.prototype,"Scene_020");var Scene_021=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight,16777215);t.alpha=.01,t.anchorOffsetX=0,t.anchorOffsetY=0,this.addChild(t),this.engine=Matter.Engine.create({enableSleeping:!1},null),this.runner=Matter.Runner.create(null),this.runner.isFixed=!0,this.render=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}}),Matter.Runner.run(this.runner,this.engine),EgretRender.run(this.render),this.engine.world.gravity.y=0;var e=SpriteUtil.createImage(this.dataVo.sData),i=64/e.width;e.scaleX=i,e.scaleY=i,this.player=Matter.Bodies.circle(50,50,i*e.width/2,{label:"player",render:{sprite:e}},0),Matter.World.add(this.engine.world,this.player);var r=SpriteUtil.createImage(this.dataVo.tData),a=Matter.Bodies.circle(SpriteUtil.stageWidth-r.width/2-10,SpriteUtil.stageHeight-r.height/2-10,r.width/2,{label:"target",isStatic:!0,render:{sprite:r}},0);Matter.World.add(this.engine.world,a),this.target=a,this.createWall(),1==this.dataVo.level?this.createEnemy0():2==this.dataVo.level?this.createEnemy1():3==this.dataVo.level?this.createEnemy2():4==this.dataVo.level?this.createEnemy3():5==this.dataVo.level?this.createEnemy4():6==this.dataVo.level?this.createEnemy5():7==this.dataVo.level&&this.createEnemy6(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),Matter.Events.on(this.engine,"collisionStart",this.collisionHandle.bind(this)),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this)},e.prototype.touchHandler=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)this.startPt=new egret.Point(t.stageX,t.stageY),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this);else if(t.type==egret.TouchEvent.TOUCH_MOVE){if(null==this.startPt)return void this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this);var e=new egret.Point(t.stageX,t.stageY);this.movePlayer(this.startPt,e),this.startPt=e}else t.type==egret.TouchEvent.TOUCH_END&&(this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.startPt=null)},e.prototype.movePlayer=function(t,e){var i=t.x-e.x,r=t.y-e.y;Matter.Body.setPosition(this.player,{x:this.player.position.x+i,y:this.player.position.y+r})},e.prototype.collisionHandle=function(t){for(var e=t.pairs,i=0,r=e;i<r.length;i++){var a=r[i];if("target"==a.bodyA.label&&"player"==a.bodyB.label){this.destroy();var s=this.timeItem.leftTime;this.timeItem.stop(),s>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):s>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else if("player"==a.bodyA.label&&"target"==a.bodyB.label){this.destroy();var s=this.timeItem.leftTime;this.timeItem.stop(),s>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):s>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else("player"==a.bodyA.label||"player"==a.bodyB.label)&&(this.destroy(),this.timeItem.stop(),EffectUtil.showResultEffect())}},e.prototype.createEnemy0=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth/3,SpriteUtil.stageHeight/2,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(SpriteUtil.stageWidth-t.width/2,SpriteUtil.stageCenterY,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e);var i=SpriteUtil.createRect(SpriteUtil.stageWidth/3,SpriteUtil.stageHeight/2,this.getSevenColor(),!0),r=Matter.Bodies.rectangle(i.width/2,SpriteUtil.stageCenterY,i.width,i.height,{isStatic:!0,render:{sprite:i}});Matter.World.add(this.engine.world,r)},e.prototype.createEnemy1=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth/3,SpriteUtil.stageHeight/2,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(SpriteUtil.stageWidth-t.width/2,SpriteUtil.stageCenterY,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e);var i=SpriteUtil.createRect(SpriteUtil.stageWidth/3,SpriteUtil.stageHeight/2,this.getSevenColor(),!0),r=Matter.Bodies.rectangle(i.width/2,SpriteUtil.stageCenterY,i.width,i.height,{isStatic:!0,render:{sprite:i}});Matter.World.add(this.engine.world,r);var a=SpriteUtil.createRect(SpriteUtil.stageWidth/2,SpriteUtil.stageWidth/3.5,this.getSevenColor(),!0),s=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,a.height/2,a.width,a.height,{isStatic:!0,render:{sprite:a}});Matter.World.add(this.engine.world,s);var n=SpriteUtil.createRect(SpriteUtil.stageWidth/2,SpriteUtil.stageWidth/3.5,this.getSevenColor(),!0),o=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageHeight-a.height/2,a.width,n.height,{isStatic:!0,render:{sprite:n}});Matter.World.add(this.engine.world,o)},e.prototype.createEnemy2=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth/1.4,SpriteUtil.stageHeight/1.3,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageCenterY,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e)},e.prototype.createEnemy3=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight/8,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(t.width/2,200,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e);var i=SpriteUtil.createRect(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight/8,this.getSevenColor(),!0),r=Matter.Bodies.rectangle(SpriteUtil.stageWidth-i.width/2,SpriteUtil.stageHeight-200,i.width,i.height,{isStatic:!0,render:{sprite:i}});Matter.World.add(this.engine.world,r);var a=SpriteUtil.createRect(SpriteUtil.stageWidth/6,SpriteUtil.stageHeight/2.4,this.getSevenColor(),!0),s=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageCenterY,a.width,a.height,{isStatic:!0,render:{sprite:a}});Matter.World.add(this.engine.world,s);var n=SpriteUtil.createRect(SpriteUtil.stageWidth-200,SpriteUtil.stageWidth/5,this.getSevenColor(),!0),o=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageCenterY,n.width,n.height,{isStatic:!0,render:{sprite:n}});Matter.World.add(this.engine.world,o)},e.prototype.createEnemy4=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight/5,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(SpriteUtil.stageCenterX-50,SpriteUtil.stageHeight/4,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e);var i=SpriteUtil.createRect(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight/8,this.getSevenColor(),!0),r=Matter.Bodies.rectangle(SpriteUtil.stageCenterX+50,SpriteUtil.stageHeight/2,i.width,i.height,{isStatic:!0,render:{sprite:i}});Matter.World.add(this.engine.world,r);var a=SpriteUtil.createRect(SpriteUtil.stageWidth-100,SpriteUtil.stageHeight/5,this.getSevenColor(),!0),s=Matter.Bodies.rectangle(SpriteUtil.stageCenterX-50,3*SpriteUtil.stageHeight/4,a.width,a.height,{isStatic:!0,render:{sprite:a}});Matter.World.add(this.engine.world,s)},e.prototype.createEnemy5=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth/6,SpriteUtil.stageHeight/1.2,this.getSevenColor(),!0),e=Matter.Bodies.rectangle(180,t.height/2,t.width,t.height,{isStatic:!0,render:{sprite:t}});Matter.World.add(this.engine.world,e);var i=SpriteUtil.createRect(SpriteUtil.stageWidth/6,SpriteUtil.stageHeight/1.2,this.getSevenColor(),!0),r=Matter.Bodies.rectangle(e.position.x+220,SpriteUtil.stageHeight-i.height/2,i.width,i.height,{isStatic:!0,render:{sprite:i}});Matter.World.add(this.engine.world,r);var a=SpriteUtil.createRect(SpriteUtil.stageWidth/6,SpriteUtil.stageHeight/1.2,this.getSevenColor(),!0),s=Matter.Bodies.rectangle(r.position.x+220,a.height/2,a.width,a.height,{isStatic:!0,render:{sprite:a}});Matter.World.add(this.engine.world,s)},e.prototype.createEnemy6=function(){var t=SpriteUtil.stageHeight/16,e=SpriteUtil.createRect(SpriteUtil.stageWidth/1.2,t,this.getSevenColor(),!0),i=Matter.Bodies.rectangle(e.width/2,160,e.width,e.height,{isStatic:!0,render:{sprite:e}});Matter.World.add(this.engine.world,i);var r=SpriteUtil.createRect(t,SpriteUtil.stageHeight/8,this.getSevenColor(),!0),a=Matter.Bodies.rectangle(e.width-r.width/2,i.position.y+e.height/2+r.height/2,r.width,r.height,{isStatic:!0,render:{sprite:r}});Matter.World.add(this.engine.world,a);var s=SpriteUtil.createRect(t,SpriteUtil.stageHeight/8,this.getSevenColor(),!0),n=Matter.Bodies.rectangle(200,i.position.y+e.height/2+s.height/2,s.width,s.height,{isStatic:!0,render:{sprite:s}});Matter.World.add(this.engine.world,n);var o=SpriteUtil.createRect(SpriteUtil.stageWidth/1.2+30,t,this.getSevenColor(),!0),h=Matter.Bodies.rectangle(SpriteUtil.stageWidth-o.width/2,a.position.y+r.height/2+120,o.width,o.height,{isStatic:!0,render:{sprite:o}});Matter.World.add(this.engine.world,h);var l=SpriteUtil.createRect(t,r.height,this.getSevenColor(),!0),c=Matter.Bodies.rectangle(a.position.x-180,h.position.y-o.height/2-l.height/2,l.width,l.height,{isStatic:!0,render:{sprite:l}});Matter.World.add(this.engine.world,c);var d=SpriteUtil.createRect(t,r.height,this.getSevenColor(),!0),p=Matter.Bodies.rectangle(h.position.x-o.width/2+d.width/2,h.position.y+o.height/2+d.height/2,d.width,d.height,{isStatic:!0,render:{sprite:d}});Matter.World.add(this.engine.world,p);var g=SpriteUtil.createRect(2*r.height+20,t,this.getSevenColor(),!0),f=Matter.Bodies.rectangle(g.width/2,p.position.y+d.height/2+120,g.width,g.height,{isStatic:!0,render:{sprite:g}});Matter.World.add(this.engine.world,f);var u=SpriteUtil.createRect(t,r.height,this.getSevenColor(),!0),m=Matter.Bodies.rectangle(g.width-u.width/2,f.position.y-g.height/2-u.height/2,u.width,u.height,{isStatic:!0,render:{sprite:u}});Matter.World.add(this.engine.world,m);var v=SpriteUtil.createRect(t-30,2*r.height,this.getSevenColor(),!0),S=Matter.Bodies.rectangle(m.position.x+160,m.position.y+g.height+50,v.width,v.height,{isStatic:!0,render:{sprite:v}});Matter.World.add(this.engine.world,S);var y=SpriteUtil.createRect(t-30,2.5*r.height,this.getSevenColor(),!0),x=Matter.Bodies.rectangle(S.position.x+140,m.position.y+g.height+.5*r.height/2+50,y.width,y.height,{isStatic:!0,render:{sprite:y}});Matter.World.add(this.engine.world,x);var C=SpriteUtil.createRect(2*r.height+20,t-30,this.getSevenColor(),!0),E=Matter.Bodies.rectangle(S.position.x-v.width/2-C.width/2,S.position.y+v.height/2-C.height/2,C.width,C.height,{isStatic:!0,render:{sprite:C}});Matter.World.add(this.engine.world,E);var w=SpriteUtil.createRect(t-30,r.height,this.getSevenColor(),!0),U=Matter.Bodies.rectangle(E.position.x-C.width/2+w.width/2,E.position.y+C.height/2+w.height/2,w.width,w.height,{isStatic:!0,render:{sprite:w}});Matter.World.add(this.engine.world,U);var T=SpriteUtil.createRect(2*r.height+y.width+20,t-30,this.getSevenColor(),!0),_=Matter.Bodies.rectangle(x.position.x+y.width/2-T.width/2,x.position.y+y.height/2+T.height/2,T.width,T.height,{isStatic:!0,render:{sprite:T}});Matter.World.add(this.engine.world,_);var M=SpriteUtil.createRect(2*r.height+y.width+40,t-40,this.getSevenColor(),!0),I=Matter.Bodies.rectangle(SpriteUtil.stageWidth-M.width/2,_.position.y+T.height/2+100,M.width,M.height,{isStatic:!0,render:{sprite:M}});Matter.World.add(this.engine.world,I),Matter.Body.setPosition(this.target,{x:I.position.x-M.width/2-80,y:this.target.position.y})},e.prototype.getSevenColor=function(){var t=Math.floor(7*Math.random()),e=[16711680,16744192,16776960,65280,65535,255,9109759];return e[t]},e.prototype.createWall=function(){var t=Matter.Bodies.rectangle(0,SpriteUtil.stageCenterY,10,SpriteUtil.stageHeight,{isStatic:!0}),e=Matter.Bodies.rectangle(SpriteUtil.stageWidth,SpriteUtil.stageCenterY,10,SpriteUtil.stageHeight,{isStatic:!0}),i=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,0,SpriteUtil.stageWidth,10,{isStatic:!0}),r=Matter.Bodies.rectangle(SpriteUtil.stageCenterX,SpriteUtil.stageHeight,SpriteUtil.stageWidth,10,{isStatic:!0});Matter.World.add(this.engine.world,[t,e,i,r])},e.prototype.destroy=function(){this.touchEnabled=!1,Matter.Events.off(this.engine,"collisionStart",this.collisionHandle),Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine)},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){t.prototype.exit.call(this),this.destroy()},e}(BaseScene);__reflect(Scene_021.prototype,"Scene_021");var Scene_022=function(t){function e(){var e=t.call(this)||this;return e.pointsArr=[],e.score=0,e.curCnt=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.sContainer=new egret.Sprite,this.addChild(this.sContainer);var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight,0);t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY,this.addChild(t),t.alpha=0,this.blackBg=t,this.scoreItem=new ScoreItem,this.scoreItem.setSTScore(this.score,this.dataVo.tData),this.addChild(this.scoreItem),this.timeItem=new TimeItem(this.dataVo.time),this.timeItem.x=SpriteUtil.stageWidth-300,this.addChild(this.timeItem);for(var e=Math.floor(SpriteUtil.stageWidth-100)/100,i=Math.floor(SpriteUtil.stageHeight-480)/100,r=0;e*i>r;r++){var a=new egret.Point(50+r%e*100,180+100*Math.floor(r/e));this.pointsArr.push(a)}this.next()},e.prototype.next=function(){var t=this;egret.Tween.get(this.blackBg).to({alpha:1},250).call(function(){t.nextHandler(),egret.Tween.get(t.blackBg).to({alpha:0},250).call(function(){egret.Tween.removeTweens(t.blackBg)})})},e.prototype.nextHandler=function(){for(var t=this.dataVo.sData,e=0;t>e;e++)this.createShape()},e.prototype.createShape=function(){var t,e=Math.floor(3*Math.random()),i=30+20*Math.random();5==this.dataVo.level?e=1:6==this.dataVo.level?e=0:this.dataVo.level>=3&&(e=Math.floor(2*Math.random())),0==e?t=SpriteUtil.createCircle(i,this.getSevenColor()):1==e?t=SpriteUtil.createRect(2*i,2*i,this.getSevenColor()):2==e&&(t=SpriteUtil.createPolygon([0,0,i,i,i,-i],this.getSevenColor())),t.rotation=360*Math.random();var r=Math.floor(this.pointsArr.length*Math.random()),a=this.pointsArr.splice(r,1)[0];t.x=a.x,t.y=a.y,this.sContainer.addChild(t),t.name="target",t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)},e.prototype.touchHandler=function(t){if(!(this.timeItem.leftTime<=0)){GameSound.instance().playSound("click");var e=t.target;if("target"==e.name)if(e.name="passed",this.score++,this.scoreItem.setSTScore(this.score),this.score>=this.dataVo.tData){var i=this.timeItem.leftTime;this.timeItem.stop(),i>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):i>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.curCnt++,this.curCnt>=this.dataVo.sData&&(this.curCnt=0,this.next());else"passed"==e.name&&(this.timeItem.stop(),EffectUtil.showResultEffect())}},e.prototype.getSevenColor=function(){var t=0,e=[16711680,16744192,16776960,255,9109759,16711935,15651566];return 1==this.dataVo.level?t=Math.floor(7*Math.random()):2==this.dataVo.level?t=Math.floor(5*Math.random()):3==this.dataVo.level?t=Math.floor(3*Math.random()):4==this.dataVo.level?t=5:5==this.dataVo.level&&(t=6),e[t]},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_022.prototype,"Scene_022");var Scene_023=function(t){function e(){var e=t.call(this)||this;return e.pools=[],e.deaths=[],e.score=0,e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this.createDirBtn("up"),e=this.createDirBtn("down"),i=this.createDirBtn("left"),r=this.createDirBtn("right");t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageHeight-2.5*t.height-300,e.x=t.x,e.y=SpriteUtil.stageHeight-e.height/2-300,i.x=SpriteUtil.stageCenterX-i.height,i.y=SpriteUtil.stageHeight-1.5*i.height-300,r.x=SpriteUtil.stageCenterX+i.height,r.y=i.y;var a=SpriteUtil.createImage("together");a.x=SpriteUtil.stageCenterX,a.y=SpriteUtil.stageHeight-1.5*i.height-300,a.scaleX=1.8,a.scaleY=1.8,a.alpha=.8,this.addChild(a),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.timeItem.x=SpriteUtil.stageWidth-300,this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.scoreItem.setSTScore(this.score,this.dataVo.tData),egret.startTick(this.loop,this)},e.prototype.loop=function(){for(var t=0,e=this.pools;t<e.length;t++){var i=e[t];if(i.x+=this.dataVo.sData,i.x>SpriteUtil.stageWidth){egret.stopTick(this.loop,this),this.timeItem.stop(),this.isCanOperate=!1,EffectUtil.showResultEffect();break}}if(this.pools.length>0){var r=this.pools[this.pools.length-1];r.x>=2*r.width&&this.flyDirection()}else this.flyDirection();return!0},e.prototype.flyDirection=function(){this.getPools()},e.prototype.getPools=function(){var t=this.getRandomDir();if(this.deaths.length>0){var e=this.deaths.shift();return e.rotation=t.rotation,e.name=t.name,e.x=-e.width/2,e.visible=!0,this.pools.push(e),e}var i=SpriteUtil.createImage("left");return i.scaleX=1.8,i.scaleY=1.8,i.rotation=t.rotation,i.name=t.name,i.y=SpriteUtil.stageCenterY-200,i.x=-i.width/2,this.addChild(i),i.visible=!0,this.pools.push(i),i},e.prototype.getRandomDir=function(){var t=Math.floor(4*Math.random());return 0==t?{rotation:0,name:"left"}:1==t?{rotation:90,name:"up"}:2==t?{rotation:180,name:"right"}:{rotation:-90,name:"down"}},e.prototype.touchHandler=function(t){if(this.isCanOperate){GameSound.instance().playSound("click");var e=t.target.name,i=this.pools.shift();if(e==i.name){if(this.deaths.push(i),i.visible=!1,this.score++,this.scoreItem.setSTScore(this.score),this.score>=this.dataVo.tData){egret.stopTick(this.loop,this),this.isCanOperate=!1;var r=this.timeItem.leftTime;this.timeItem.stop(),r>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):r>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}}else this.isCanOperate=!1,egret.stopTick(this.loop,this),EffectUtil.showResultEffect()}},e.prototype.createDirBtn=function(t){void 0===t&&(t="");var e=SpriteUtil.createImage("circle");e.scaleX=1.8,e.scaleY=1.8,e.touchEnabled=!1;var i=new egret.TextField;i.size=80,i.bold=!0,i.textColor=16777215,i.stroke=1,i.strokeColor=255,"up"==t?i.text="上":"down"==t?i.text="下":"left"==t?i.text="左":"right"==t&&(i.text="右"),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2;var r=new egret.Sprite;return r.addChild(e),r.addChild(i),this.addChild(r),r.touchEnabled=!0,r.name=t,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),r},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_023.prototype,"Scene_023");var Scene_024=function(t){function e(){var e=t.call(this)||this;return e.startPt=null,e.pools=[],e.score=0,e.intervalId=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight,16777215);t.alpha=.01,t.anchorOffsetX=0,t.anchorOffsetY=0,this.addChild(t),this.engine=Matter.Engine.create({enableSleeping:!1},null),this.runner=Matter.Runner.create(null),this.runner.isFixed=!0,this.render=EgretRender.create({engine:this.engine,container:this,options:{width:SpriteUtil.stageWidth,height:SpriteUtil.stageHeight,wireframes:!0}}),Matter.Runner.run(this.runner,this.engine),EgretRender.run(this.render),this.engine.world.gravity.y=0;var e=SpriteUtil.createImage("basketball"),i=Matter.Bodies.circle(SpriteUtil.stageCenterX-100,SpriteUtil.stageCenterY,e.width/2,{label:"player",collisionFilter:{category:2,mask:10},render:{sprite:e}},0),r=SpriteUtil.createImage("football"),a=Matter.Bodies.circle(SpriteUtil.stageCenterX+100,SpriteUtil.stageCenterY,r.width/2,{label:"player",collisionFilter:{category:4,mask:12},render:{sprite:r}},0);Matter.World.add(this.engine.world,[i,a]),this.player1=i,this.player2=a,Matter.Events.on(this.engine,"collisionStart",this.collision.bind(this)),this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.scoreItem.setSTScore(this.score,this.dataVo.tData),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this.next()},e.prototype.next=function(){var t=this;this.intervalId=egret.setInterval(function(){for(var e=0;e<t.dataVo.sData.length;e++)t.getPools(t.dataVo.sData[e])},this,this.dataVo.time)},e.prototype.getPools=function(t){var e=!1,i=0,r=0,a={x:0,y:0},s=1+Math.floor(3*Math.random());
1==t?(i=40+(SpriteUtil.stageWidth-80)*Math.random(),r=-64,a.y=s):2==t?(i=40+(SpriteUtil.stageWidth-80)*Math.random(),r=SpriteUtil.stageHeight+64,a.y=-s):3==t?(i=-64,r=40+(SpriteUtil.stageHeight-80)*Math.random(),a.x=s):4==t&&(i=SpriteUtil.stageWidth+64,r=40+(SpriteUtil.stageHeight-80)*Math.random(),a.x=-s);for(var n=0,o=this.pools;n<o.length;n++){var h=o[n],l=!1;if(h.velocity.x>0?h.position.x>=SpriteUtil.stageWidth+h.render.sprite.width&&(l=!0):h.velocity.x<0?h.position.x<=-h.render.sprite.width&&(l=!0):h.velocity.y>0?h.position.y>=SpriteUtil.stageHeight+h.render.sprite.width&&(l=!0):h.velocity.y<0&&h.position.y<=-h.render.sprite.width&&(l=!0),l){if(this.score++,this.scoreItem.setSTScore(this.score),this.score>=this.dataVo.tData)return this.destroy(),EffectUtil.showResultEffect(EffectUtil.PERFECT),null;Matter.Body.setPosition(h,{x:i,y:r}),e=!0}}if(e)return null;var c=SpriteUtil.createImage(CommonUtil.allEmoji[Math.floor(20*Math.random())]),d=Matter.Bodies.circle(i,r,c.width/2,{frictionAir:0,friction:0,label:"enemy",collisionFilter:{category:8,mask:6},render:{sprite:c}},0);return Matter.World.add(this.engine.world,d),Matter.Body.setVelocity(d,a),this.pools.push(d),d},e.prototype.collision=function(t){for(var e=t.pairs,i=0,r=e;i<r.length;i++){var a=r[i];("player"==a.bodyA.label||"player"==a.bodyB.label)&&(this.destroy(),EffectUtil.showResultEffect())}},e.prototype.touchHandler=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)this.startPt=new egret.Point(t.stageX,t.stageY),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this);else if(t.type==egret.TouchEvent.TOUCH_MOVE){if(null==this.startPt)return void this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this);var e=new egret.Point(t.stageX,t.stageY);this.movePlayer(this.startPt,e),this.startPt=e}else t.type==egret.TouchEvent.TOUCH_END&&(this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.startPt=null)},e.prototype.movePlayer=function(t,e){var i=t.x-e.x,r=t.y-e.y,a=this.player1.position.x+i,s=this.player1.position.y+r,n=this.player2.position.x-i,o=this.player2.position.y-r;a<this.player1.render.sprite.width/2?a=this.player1.render.sprite.width/2:a>SpriteUtil.stageWidth-this.player1.render.sprite.width/2&&(a=SpriteUtil.stageWidth-this.player1.render.sprite.width/2),s<this.player1.render.sprite.width/2?s=this.player1.render.sprite.width/2:s>SpriteUtil.stageHeight-this.player1.render.sprite.width/2&&(s=SpriteUtil.stageHeight-this.player1.render.sprite.width/2),n<this.player2.render.sprite.width/2?n=this.player2.render.sprite.width/2:n>SpriteUtil.stageWidth-this.player2.render.sprite.width/2&&(n=SpriteUtil.stageWidth-this.player2.render.sprite.width/2),o<this.player2.render.sprite.width/2?o=this.player2.render.sprite.width/2:o>SpriteUtil.stageHeight-this.player2.render.sprite.width/2&&(o=SpriteUtil.stageHeight-this.player2.render.sprite.width/2),Matter.Body.setPosition(this.player1,{x:a,y:s}),Matter.Body.setPosition(this.player2,{x:n,y:o})},e.prototype.destroy=function(){egret.clearInterval(this.intervalId),Matter.Runner.stop(this.runner),EgretRender.stop(),Matter.Engine.clear(this.engine),Matter.Events.off(this.engine,"collisionStart",this.collision)},e}(BaseScene);__reflect(Scene_024.prototype,"Scene_024");var Scene_025=function(t){function e(){var e=t.call(this)||this;return e.stonesArr=[],e.housesArr=[],e.curIndex=0,e.curCount=0,e.isCanOperate=!0,e.randomArr=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this.createJoyHouse(),this.handSpr=SpriteUtil.createImage("paper"),this.handSpr.visible=!1,this.handSpr.scaleX=2,this.handSpr.scaleY=2,this.addChild(this.handSpr),this.next(),this.eatText=SpriteUtil.createText("吃",128),this.addChild(this.eatText),this.eatText.visible=!1,this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.next=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,r,a;return __generator(this,function(s){switch(s.label){case 0:return this.curCount<=0?(this.checkResult(),this.isCanOperate=!0,[2]):(this.curIndex++,t=this.housesArr.length,this.curIndex>=t&&(this.curIndex=0),e=this.getPools(),i=this.housesArr[this.curIndex],r=i.sprite.parent.localToGlobal(i.sprite.x,i.sprite.y),this.handSpr.texture=RES.getRes("images_json#point"),this.handSpr.visible=!0,this.handSpr.rotation=0,this.handSpr.x=r.x,this.handSpr.y=r.y,[4,this.timeOutEff(500)]);case 1:return s.sent(),i.sprite.addChild(e),i.count++,a=i.sprite.getChildAt(0),a.text=i.count,a.anchorOffsetX=a.width/2,this.curCount--,this.handSpr.visible=!1,this.next(),[2]}})})},e.prototype.checkResult=function(){var t=this,e=this.housesArr.length;this.curIndex>=e&&(this.curIndex=0);for(var i=[],r=this.curIndex;;r+=2){var a=r+1,s=r+2;a%=e,s%=e;var n=this.housesArr[a],o=this.housesArr[s];if(!(0==n.count&&o.count>0))break;if(i.push(s),s==this.curIndex)break}if(0==i.length)return void(this.isCanOperate=!0);var h=0,l=function(){var e=t.housesArr[i[h]],r=e.sprite.parent.localToGlobal(e.sprite.x,e.sprite.y);t.eatText.x=r.x,t.eatText.y=r.y,t.eatText.visible=!0;var a=egret.setTimeout(function(){for(egret.clearTimeout(a),t.eatText.visible=!1;e.sprite.numChildren>1;)e.sprite.removeChildAt(e.sprite.numChildren-1);e.count=0;var r=e.sprite.getChildAt(0);return r.text=e.count,r.anchorOffsetX=r.width/2,h++,t.timeItem.leftTime<0?void 0:h>=i.length?t.isCanPass()?(t.timeItem.stop(),void EffectUtil.showResultEffect(EffectUtil.PERFECT)):t.isFail()?(t.timeItem.stop(),void EffectUtil.showResultEffect()):void(t.isCanOperate=!0):void l()},t,800)};l()},e.prototype.isCanPass=function(){for(var t=0,e=this.housesArr;t<e.length;t++){var i=e[t];if(0!=i.count)return!1}return!0},e.prototype.isFail=function(){for(var t=0,e=0,i=this.housesArr;e<i.length;e++){var r=i[e];t+=r.count}return t<this.dataVo.sData.length/2?!0:!1},e.prototype.getPools=function(){for(var t=-40+80*Math.random(),e=-40+80*Math.random(),i=180*Math.random(),r=0,a=this.stonesArr;r<a.length;r++){var s=a[r];if(!s.visible||null==s.parent)return s.visible=!0,s.x=t,s.y=e,s.rotation=i,s}var n=SpriteUtil.createImage("stone");return n.scaleX=.4,n.scaleY=.4,n.x=t,n.y=e,n.rotation=i,n.touchEnabled=!1,this.stonesArr.push(n),n},e.prototype.createJoyHouse=function(){var t=new egret.Sprite,e=0;3==this.dataVo.level?e=Math.random()>.5?-90:90:5==this.dataVo.level&&(e=Math.random()>.5?45:-45);for(var i=this.dataVo.sData.length,r=0;i>r;r++){var a=new egret.Sprite;a.graphics.beginFill(0,.01),a.graphics.lineStyle(5,0),a.graphics.drawCircle(0,0,60),a.graphics.endFill(),t.addChild(a);var s=this.getPoint(r,a.width);a.x=s.x,a.y=s.y,a.touchEnabled=!0,a.name="house_"+r;var n=SpriteUtil.createText(this.dataVo.sData[r],100);n.alpha=.5,a.addChild(n),n.rotation=-e,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this);for(var o=0;o<this.dataVo.sData[r];o++){var h=this.getPools();a.addChild(h)}this.housesArr.push({sprite:a,count:this.dataVo.sData[r]})}this.addChild(t),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.rotation=e,t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY},e.prototype.getPoint=function(t,e){var i=4,r=0,a=0,s=0;if(4==this.dataVo.level&&(i=3),6==this.dataVo.level)if(12>=t){var n=2*(e+10),o=2*(e+10),h=0,l=2*(e+10),c=2*t*Math.asin((e/2+2.5)/(2*e+20));a=e/2+(h-n)*Math.cos(c)-(l-o)*Math.sin(c)+n,s=e/2+(l-o)*Math.cos(c)+(h-n)*Math.sin(c)+o}else t-=12,r=4-t%i,a=e/2+r*(e+10),s=e/2+2*e+20+Math.floor(t/i)*(e+10);else if(7==this.dataVo.level||8==this.dataVo.level){if(0==this.randomArr.length){for(var d=[],p=0;24>p;p++)d.push({x:p%4*(e+10),y:Math.floor(p/4)*(e+10)});this.randomArr=d}var g=this.randomArr.splice(Math.floor(this.randomArr.length*Math.random()),1);a=e/2+g[0].x,s=e/2+g[0].y}else r=Math.floor(t/i)%2==0?t%i:3-t%i,a=e/2+r*(e+10),s=e/2+Math.floor(t/i)*(e+10);return new egret.Point(a,s)},e.prototype.touchHandler=function(t){!this.isCanOperate||this.timeItem.leftTime<=0||(this.curIndex=t.target.name.split("_")[1],this.isCanOperate=!1,this.playGetAnim()["catch"](function(t){}))},e.prototype.playGetAnim=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(r){switch(r.label){case 0:return t=this.housesArr[this.curIndex],0==t.count?(this.isCanOperate=!0,[2]):(e=t.sprite.parent.localToGlobal(t.sprite.x,t.sprite.y),this.handSpr.texture=RES.getRes("images_json#paper"),this.handSpr.visible=!0,this.handSpr.rotation=-60,this.handSpr.x=e.x,this.handSpr.y=e.y,[4,this.timeOutEff()]);case 1:return r.sent(),this.handSpr.texture=RES.getRes("images_json#rock"),this.timeItem.leftTime<0?[2]:[4,this.timeOutEff()];case 2:for(r.sent(),this.handSpr.visible=!1;t.sprite.numChildren>1;)t.sprite.removeChildAt(t.sprite.numChildren-1);return this.curCount=t.count,t.count=0,i=t.sprite.getChildAt(0),i.text=t.count,i.anchorOffsetX=i.width/2,this.timeItem.leftTime<0?[2]:(this.next(),[2])}})})},e.prototype.timeOutEff=function(t){var e=this;void 0===t&&(t=200);var i=new Promise(function(i,r){var a=egret.setTimeout(function(){egret.clearTimeout(a),i()},e,t)});return i},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_025.prototype,"Scene_025");var Scene_026=function(t){function e(){var e=t.call(this)||this;return e.pointsArr=[],e.passedArr=[],e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight,16777215);t.alpha=.01,t.anchorOffsetX=0,t.anchorOffsetY=0,t.touchEnabled=!0,this.addChild(t),this.createJoyHouse(),this.lineShape=new egret.Shape,this.addChild(this.lineShape);var e=SpriteUtil.createText(this.dataVo.extData,36,16316671);e.x=SpriteUtil.stageCenterX,e.y=160,this.addChild(e),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this)},e.prototype.createJoyHouse=function(){for(var t=new egret.Sprite,e=this.dataVo.sData,i=Math.floor(Math.sqrt(e)),r=0;e>r;r++){var a=new egret.Sprite;a.graphics.beginFill(0,.01),a.graphics.lineStyle(5,0),a.graphics.drawCircle(0,0,60),a.graphics.endFill(),a.graphics.beginFill(16773120),a.graphics.drawCircle(0,0,10),a.graphics.endFill(),t.addChild(a),a.x=a.width/2+r%i*160,a.y=a.width/2+160*Math.floor(r/i),a.touchEnabled=!0,a.name="house_"+r}this.addChild(t),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY},e.prototype.checkResult=function(){var t=this.dataVo.tData.length,e=this.pointsArr.length;if(t!=e)return!1;for(var i=0;t>i;i++)if(this.dataVo.tData[i]!=this.passedArr[i])return!1;return!0},e.prototype.touchHandler=function(t){if(this.isCanOperate&&!(this.timeItem.leftTime<=0)){var e=t.target,i=e.name,r=t.type,a=t.stageX,s=t.stageY;if(r==egret.TouchEvent.TOUCH_BEGIN){if(i.search("house")<0)return;this.passedArr.push(i.split("_")[1]),this.pointsArr.push(e.parent.localToGlobal(e.x,e.y))}else if(r==egret.TouchEvent.TOUCH_MOVE){if(0==this.passedArr.length)return;this.handleMove({x:a,y:s}),i.search("house")>=0&&this.passedArr.indexOf(i.split("_")[1])<0&&(this.pointsArr.push(e.parent.localToGlobal(e.x,e.y)),this.passedArr.push(i.split("_")[1]))}else r==egret.TouchEvent.TOUCH_END&&this.handleMove(null)}},e.prototype.handleMove=function(t){var e=this,i=this.pointsArr.length;if(!(0>=i))if(null==t)if(this.checkResult()){this.drawPath(null,16753920),this.isCanOperate=!1;var r=this.timeItem.leftTime;this.timeItem.stop(),r>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):r>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}else this.isCanOperate=!1,this.drawPath(null,16711680),egret.Tween.get(this.lineShape).to({alpha:.5},300).to({alpha:1},300).to({alpha:.5},300).call(function(){egret.Tween.removeTweens(e.lineShape),e.lineShape.graphics.clear(),e.lineShape.alpha=1,e.pointsArr=[],e.passedArr=[],e.isCanOperate=!0},this);else this.drawPath(t,16776960)},e.prototype.drawPath=function(t,e){var i=this.pointsArr.length,r=this.pointsArr[0];this.lineShape.graphics.clear(),this.lineShape.graphics.lineStyle(36,e,.8),this.lineShape.graphics.beginFill(e,.01),this.lineShape.graphics.moveTo(r.x,r.y);for(var a=1;i>a;a++)this.lineShape.graphics.lineTo(this.pointsArr[a].x,this.pointsArr[a].y);t&&this.lineShape.graphics.lineTo(t.x,t.y),this.lineShape.graphics.endFill()},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_026.prototype,"Scene_026");var Scene_027=function(t){function e(){var e=t.call(this)||this;return e.pools1=[],e.pools2=[],e.isCanOperate=!0,e.count=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.direction=this.dataVo.extData.direction,0!=this.direction[0]&&0!=this.direction[1]?(this.createJustRect(this.dataVo.sData/2),this.createOppRect(this.dataVo.sData/2)):0!=this.direction[0]?this.createJustRect(this.dataVo.sData):0!=this.direction[1]&&this.createOppRect(this.dataVo.sData),this.scoreItem=new ScoreItem,this.scoreItem.setSTLose(0,this.dataVo.tData),this.addChild(this.scoreItem),egret.startTick(this.loop,this)},e.prototype.loop=function(){return 1==this.direction[0]?this.container1.x+=5:2==this.direction[0]&&(this.container1.y+=5),3==this.direction[1]?this.container2.x-=5:4==this.direction[1]&&(this.container2.y-=5),this.handleContainer()?void 0:(this.checkResult(),!1)},e.prototype.handleContainer=function(){for(var t=0,e=this.pools1;t<e.length;t++){var i=e[t];if(this.isMiss(i,this.direction[0])){var r=i.name.split("_")[1];if(this.pools1.splice(parseInt(r),1),this.container1.removeChild(i),i.name="",i.touchEnabled=!1,i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler),this.count++,this.scoreItem.setSTLose(this.count),this.count>=this.dataVo.tData)return this.isCanOperate=!1,egret.stopTick(this.loop,this),EffectUtil.showResultEffect(),!0}}for(var a=0,s=this.pools2;a<s.length;a++){var i=s[a];if(this.isMiss(i,this.direction[1])){var r=i.name.split("_")[1];if(this.pools2.splice(parseInt(r),1),this.container2.removeChild(i),i.name="",i.touchEnabled=!1,i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler),this.count++,this.scoreItem.setSTLose(this.count),this.count>=this.dataVo.tData)return this.isCanOperate=!1,egret.stopTick(this.loop,this),EffectUtil.showResultEffect(),!0}}return!1},e.prototype.createJustRect=function(t){this.container1=new egret.Sprite;for(var e=0;t>e;e++){var i=this.getPoint(e,this.direction[0]),r=Math.random()>.5?0:16777215,a=SpriteUtil.createRect(i.sdt,i.sdt,r,!0);a.name=0==r?"black_"+e:"white_"+e,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),a.x=i.xx,a.y=i.yy,this.container1.addChild(a),this.pools1.push(a)}1==this.direction[0]?(this.container1.x=-this.container1.width,this.container1.y=250):2==this.direction[0]&&(this.container1.x=this.isOnlyOne()?SpriteUtil.stageCenterX-this.container1.width/2:SpriteUtil.stageCenterX-this.container1.width,this.container1.y=-this.container1.height),this.addChild(this.container1)},e.prototype.createOppRect=function(t){this.container2=new egret.Sprite;for(var e=0;t>e;e++){var i=this.getPoint(e,this.direction[1]),r=Math.random()>.5?0:16777215,a=SpriteUtil.createRect(i.sdt,i.sdt,r,!0);a.name=0==r?"black_"+e:"white_"+e,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),a.x=i.xx,a.y=i.yy,this.container2.addChild(a),this.pools2.push(a)}3==this.direction[1]?(this.container2.x=SpriteUtil.stageWidth,this.container2.y=this.isOnlyOne()?250:this.container1.y+this.container1.height):(this.container2.x=this.isOnlyOne()?SpriteUtil.stageCenterX-this.container2.width/2:SpriteUtil.stageCenterX,this.container2.y=SpriteUtil.stageHeight),this.addChild(this.container2)},e.prototype.getPoint=function(t,e){var i=0,r=3,a=3,s=0,n=0;return this.isOnlyOne()?this.dataVo.level<=2?(r=3,a=3):(r=4,a=4):(r=4,a=2),1==e||3==e?(i=(SpriteUtil.stageHeight-400)/r,s=Math.floor(t/a)*i+i/2,n=t%a*i+i/2):(i=(SpriteUtil.stageWidth-8)/r,s=t%a*i+i/2,n=Math.floor(t/a)*i+i/2),{xx:s,yy:n,sdt:i}},e.prototype.isOnlyOne=function(){return 0!=this.direction[0]&&0!=this.direction[1]?!1:!0},e.prototype.isMiss=function(t,e){var i=t.name;if(i.search("black")<0)return!1;if(0!=this.direction[0]){var r=this.container1.localToGlobal(t.x,t.y);if(1==e){if(r.x>SpriteUtil.stageWidth+t.width/2)return!0}else if(2==e&&r.y>SpriteUtil.stageHeight+t.height/2)return!0}if(0!=this.direction[1]){var r=this.container2.localToGlobal(t.x,t.y);if(3==e){if(r.x<-t.width/2)return!0}else if(4==e&&r.y<-t.height/2)return!0}return!1},e.prototype.checkResult=function(){var t=!1;1==this.direction[0]?this.container1.x>SpriteUtil.stageWidth&&(t=!0):2==this.direction[0]&&this.container1.y>SpriteUtil.stageHeight&&(t=!0),3==this.direction[1]?this.container2.x<-this.container2.width&&(t=!0):4==this.direction[1]&&this.container2.y<-this.container2.height&&(t=!0),t&&(egret.stopTick(this.loop,this),this.isCanOperate=!1,this.count<this.dataVo.tData/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):this.count<2*this.dataVo.tData/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD))},e.prototype.touchHandler=function(t){if(this.isCanOperate){var e=t.target;if(e.name.search("black")>=0){var i=this.pools1.indexOf(e);i>=0?(this.pools1.splice(i,1),this.container1.removeChild(e)):(i=this.pools2.indexOf(e),this.pools2.splice(i,1),this.container2.removeChild(e)),e.name="",e.touchEnabled=!1,e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler)}else e.name.search("white")>=0&&(this.isCanOperate=!1,EffectUtil.showResultEffect(),egret.stopTick(this.loop,this))}},e}(BaseScene);__reflect(Scene_027.prototype,"Scene_027");var Scene_028=function(t){function e(){var e=t.call(this)||this;return e.btnArr=[],e.numsVec={},e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem);for(var t=this.dataVo.sData.length,e=0;t>e;e++)this.numsVec[e]=0;this.playAnim()},e.prototype.touchHandler=function(t){if(this.isCanOperate){var e=t.target.name,i=e.split("_")[1],r=this.btnArr[i].getChildAt(0),a=parseInt(r.text.split("x")[1]);if(a++,r.text="x"+a,this.numsVec[i]<a)this.isCanOperate=!1,this.timeItem.stop(),EffectUtil.showResultEffect();else if(this.isCanPass()){this.isCanOperate=!1;var s=this.timeItem.leftTime;this.timeItem.stop(),s>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):s>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}}},e.prototype.isCanPass=function(){for(var t=this.btnArr.length,e=0;t>e;e++){var i=this.btnArr[e].getChildAt(0),r=parseInt(i.text.split("x")[1]);if(r!=this.numsVec[e])return!1}return!0},e.prototype.playAnim=function(){var t=this,e=this.dataVo.sData.length,i=this.dataVo.tData[0],r=i,a=this.dataVo.tData[1],s=egret.setInterval(function(){var n=Math.floor(e*Math.random()),o=SpriteUtil.createImage(t.dataVo.sData[n]);t.numsVec[n]++,o.x=-o.width/2,o.y=SpriteUtil.stageCenterY-150,t.addChild(o),egret.Tween.get(o).to({x:SpriteUtil.stageCenterX-250},a).to({x:SpriteUtil.stageCenterX,y:SpriteUtil.stageCenterY-300},a).to({x:SpriteUtil.stageCenterX+250,y:SpriteUtil.stageCenterY-160},a).to({x:SpriteUtil.stageWidth+o.width},a).call(function(){egret.Tween.removeTweens(o),t.removeChild(o),r--,0>=i&&0>=r&&(t.createBtnList(),t.timeItem.start())}),i--,0>=i&&egret.clearInterval(s)},this,250)},e.prototype.createBtnList=function(){var t=this.dataVo.sData.length,e=SpriteUtil.createText("你能确定各自出现次数吗？",48,16316671);e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY-200,this.addChild(e);for(var i=new egret.Sprite,r=0;t>r;r++){var a=this.createBtn(this.dataVo.sData[r],r);a.x=a.width/2+200*r,a.y=a.height/2,i.addChild(a),this.btnArr.push(a)}i.x=SpriteUtil.stageCenterX-i.width/2,i.y=e.y+e.height-40,this.addChild(i)},e.prototype.createBtn=function(t,e){var i=new egret.Sprite,r=SpriteUtil.createImage(t,!0);r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),r.scaleX=2,r.scaleY=2,r.name=t+"_"+e;var a=SpriteUtil.createText("x0",48,16316671);return a.touchEnabled=!1,r.y=a.height+80,i.addChild(a),i.addChild(r),i},e}(BaseScene);__reflect(Scene_028.prototype,"Scene_028");var Scene_029=function(t){function e(){var e=t.call(this)||this;return e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.createItems(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.clkHandler=function(t){var e=this;if(!(this.timeItem&&this.timeItem.leftTime<=0)&&this.isCanOperate)if(GameSound.instance().playSound("click"),this.isCanOperate=!1,this.currentSelect)if(this.currentSelect==t.target)this.isCanOperate=!0;else{var i=t.target;this.playAnim(i,!0).then(function(){e.currentSelect.name==i.name?(e.currentSelect.alpha=.5,e.currentSelect.touchEnabled=!1,i.alpha=.5,i.touchEnabled=!1,e.isCanOperate=!0,e.currentSelect=null,e.checkResult()):Promise.all([e.playAnim(i,!1),e.playAnim(e.currentSelect,!1)]).then(function(){e.currentSelect=null,e.isCanOperate=!0})})}else this.currentSelect=t.target,this.playAnim(this.currentSelect,!0).then(function(){e.isCanOperate=!0})},e.prototype.checkResult=function(){if(this.isCanPass()){var t=this.timeItem.leftTime;this.timeItem.stop(),t>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):t>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}},e.prototype.isCanPass=function(){for(var t=0,e=this.group.$children;t<e.length;t++){var i=e[t];if(.5!=i.alpha)return!1}return!0},e.prototype.playAnim=function(t,e){var i=new Promise(function(i,r){egret.Tween.get(t).to({scaleX:0},100).call(function(){t.getChildAt(0).visible=e}).to({scaleX:1},100).wait(300).call(function(){egret.Tween.removeTweens(t),i()})});return i},e.prototype.createItems=function(){var t=this.dataVo.sData,e=t.concat(t),i=e.length,r=Math.round(Math.sqrt(i)),a=Math.round(SpriteUtil.stageWidth-50)/r;e.sort(function(t,e){return Math.random()>.5?1:Math.random()<.5?-1:0}),this.group=new egret.Sprite;for(var s=e.length,n=0;s>n;n++){var o=SpriteUtil.createImage(e[n],!0);o.scaleX=a/o.width,o.scaleY=a/o.height,o.touchEnabled=!1,o.visible=!1;var h=o.width*o.scaleX,l=new egret.Sprite;l.graphics.beginFill(16738922),l.graphics.drawRect(-h/2,-h/2,h,h),l.graphics.endFill(),l.addChild(o),l.touchEnabled=!0,l.name=e[n],l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clkHandler,this),l.x=l.width/2+(a+2)*(n%r),l.y=l.width/2+(a+2)*Math.floor(n/r),this.group.addChild(l)}this.addChild(this.group),this.group.x=SpriteUtil.stageCenterX-this.group.width/2,this.group.y=200},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.exit=function(){for(t.prototype.exit.call(this);this.numChildren>1;){var e=this.getChildAt(this.numChildren-1);e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clkHandler,this),this.removeChild(e)}},e}(BaseScene);__reflect(Scene_029.prototype,"Scene_029");var Scene_030=function(t){function e(){var e=t.call(this)||this;return e.pointsArr=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this.createBalls(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem)},e.prototype.createBalls=function(){for(var t=0;t<this.dataVo.sData[0];t++){var e=SpriteUtil.createCircle(80,this.getColor());e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY,this.addChild(e),e.name="first_"+this.dataVo.tData,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),this.playAnim(e)}},e.prototype.touchHandler=function(t){var e=this;if(!(this.timeItem.leftTime<=0)){var i=t.target,r=i.name.split("_")[0],a=i.name.split("_")[1];if("first"==r){var s=i.x,n=i.y,o=i.width;if(this.removeChild(i),egret.Tween.removeTweens(i),a>0){var h=this.calculateAngle(o,s,n,this.dataVo.sData[1]),l={x:s,y:n,radius:o/3,points:h};a--,this.playExplosion(l,r+"_"+a)}else{var h=this.calculateAngle(o,s,n,50),l={x:s,y:n,radius:o/50,points:h,num:50};this.playDestroy(l).then(function(){e.checkResult()})}}}},e.prototype.checkResult=function(){if(1==this.numChildren){var t=this.timeItem.leftTime;this.timeItem.stop(),t>=2*this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.PERFECT):t>=this.dataVo.time/3?EffectUtil.showResultEffect(EffectUtil.GREAT):EffectUtil.showResultEffect(EffectUtil.GOOD)}},e.prototype.playExplosion=function(t,e){for(var i=this,r=this.dataVo.sData[1],a=0,s=t.points,n=function(){var n=SpriteUtil.createCircle(t.radius,o.getColor());o.addChild(n),n.touchEnabled=!0,n.x=t.x,n.y=t.y,n.name=e,n.addEventListener(egret.TouchEvent.TOUCH_TAP,o.touchHandler,o);var h=s[a%r];egret.Tween.get(n).to({x:h.x,y:h.y},800,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(n),i.playAnim(n)}),a++},o=this;r>a;)n()},e.prototype.playDestroy=function(t){var e=this,i=new Promise(function(i,r){for(var a=t.num,s=0,n=t.points,o=function(){var r=SpriteUtil.createCircle(t.radius,e.getColor());e.addChild(r),r.x=t.x,r.y=t.y;var o=n[s%a];egret.Tween.get(r).to({x:o.x,y:o.y},300,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(r),e.removeChild(r),s==a&&i()}),s++};a>s;)o()});return i},e.prototype.calculateAngle=function(t,e,i,r){for(var a=360/r,s=[],n=0;r>n;n++){var o=e+2*t*Math.cos(n*a/Math.PI),h=i-2*t*Math.sin(n*a/Math.PI);s.push({x:o,y:h})}return s},e.prototype.playAnim=function(t){var e=this;egret.Tween.get(t).to({x:t.width/2+(SpriteUtil.stageWidth-t.width)*Math.random(),y:t.width/2+(SpriteUtil.stageHeight-400)*Math.random()},2e3).call(function(){egret.Tween.removeTweens(t),e.playAnim(t)})},e.prototype.getColor=function(){var t=[16711680,16776960,5577355,255,16711935,16777215,0],e=Math.floor(t.length*Math.random());return t[e]},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e}(BaseScene);__reflect(Scene_030.prototype,"Scene_030");var Scene_031=function(t){function e(){var e=t.call(this)||this;return e.ballAngle=0,e.curIndex=0,e.enemies=[],e.score=0,e.direction=1,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=SpriteUtil.createRect(SpriteUtil.stageWidth,SpriteUtil.stageHeight,0);t.alpha=.01,t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY,this.addChild(t),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this);var e=new egret.Sprite;e.graphics.beginFill(0,.01),e.graphics.lineStyle(2,16316671),e.graphics.drawCircle(0,0,300),e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY,this.addChild(e),this.startPt=new egret.Point(e.x+e.width/2,e.y),this.createBall(),this.createEnemy(),this.scoreItem=new ScoreItem,this.addChild(this.scoreItem),this.scoreItem.setSTScore(this.score,this.dataVo.tData),egret.startTick(this.loop,this)},e.prototype.loop=function(t){var e=this.startPt.x-SpriteUtil.stageCenterX,i=this.startPt.y-SpriteUtil.stageCenterY;this.ball.x=e*Math.cos(this.ballAngle)-i*Math.sin(this.ballAngle)+SpriteUtil.stageCenterX,this.ball.y=i*Math.cos(this.ballAngle)+e*Math.sin(this.ballAngle)+SpriteUtil.stageCenterY,this.ballAngle+=this.dataVo.extData.speed*this.direction*Math.PI/180/2,Math.abs(this.ballAngle)>=2*Math.PI&&(this.ballAngle=this.ballAngle%(2*Math.PI));var r=this.enemies.length;if(0==r)return void this.createEnemy();for(var a=r-1;a>=0;a--){var s=this.enemies[a],n=Math.abs(this.ballAngle-s.angle);if(1e4==s.index&&(s.shape.rotation+=-1*this.direction),n<5*Math.PI/180||Math.abs(n-2*Math.PI)<5*Math.PI/180)if(this.curIndex==s.index){if(this.removeChild(s.shape),this.enemies.splice(a,1),this.score++,this.scoreItem.setSTScore(this.score),this.scoreItem.isCanPass()){egret.stopTick(this.loop,this),EffectUtil.showResultEffect(EffectUtil.PERFECT);break}}else if(1e4==s.index)this.direction=-1*this.direction,this.removeChild(s.shape),this.enemies.splice(a,1);else{egret.stopTick(this.loop,this),this.removeChild(this.ball);var o=this.calculateAngle(40,this.ball.x,this.ball.y,50);this.playDestroy({x:this.ball.x,y:this.ball.y,num:50,radius:2,points:o}).then(function(){EffectUtil.showResultEffect()})}}return!1},e.prototype.createBall=function(){for(var t=this.dataVo.sData,e=new egret.Sprite,i=[16711680,16776960,16743680,255,16711935,65535,0],r=0;t>r;r++){var a=new egret.Shape;a.graphics.beginFill(i[r]),a.graphics.drawCircle(0,0,20),a.graphics.endFill(),a.visible=this.curIndex==r,e.addChild(a)}this.ball=e,this.ball.x=this.startPt.x,this.ball.y=this.startPt.y,this.addChild(this.ball);for(var s=new egret.Sprite,r=0;t>r;r++){var a=new egret.Shape;a.graphics.beginFill(i[r]),a.graphics.drawCircle(0,0,180),a.graphics.endFill(),s.addChild(a),a.visible=this.curIndex==r}s.x=SpriteUtil.stageCenterX,s.y=SpriteUtil.stageCenterY,this.addChild(s),s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),this.ballBtn=s},e.prototype.touchHandler=function(t){this.curIndex++,this.curIndex>=this.dataVo.sData&&(this.curIndex=0);for(var e=0;e<this.ball.numChildren;e++)this.ball.$children[e].visible=e==this.curIndex,this.ballBtn.$children[e].visible=e==this.curIndex},e.prototype.createEnemy=function(){for(var t=this.dataVo.sData,e=[16711680,16776960,16743680,255,16711935,65535,0],i=this.startPt.x-SpriteUtil.stageCenterX,r=this.startPt.y-SpriteUtil.stageCenterY,a=this.dataVo.extData.num,s=100*this.dataVo.extData.rate,n=Math.ceil(100*Math.random()),o=s>n?Math.floor(a*Math.random()):-1,h=0;a>h;h++)if(h==o){var l=SpriteUtil.createImage("refresh"),c=(this.ballAngle+(50*(h+1)+30*Math.random())*Math.PI/180)%(2*Math.PI),d=new egret.Sprite;d.graphics.beginFill(65280),d.graphics.drawCircle(0,0,l.width/2+5),d.graphics.endFill(),d.addChild(l);var p=40/d.width;d.scaleX=p,d.scaleY=p,d.x=i*Math.cos(c)-r*Math.sin(c)+SpriteUtil.stageCenterX,d.y=r*Math.cos(c)+i*Math.sin(c)+SpriteUtil.stageCenterY,this.enemies.push({index:1e4,angle:c,shape:d}),this.addChild(d),a++}else{var g=new egret.Shape,f=Math.floor(t*Math.random());g.graphics.beginFill(e[f]),g.graphics.drawCircle(0,0,20+10*Math.random()),g.graphics.endFill();var c=(this.ballAngle+(60*(h+1)+30*Math.random())*Math.PI/180)%(2*Math.PI);g.x=i*Math.cos(c)-r*Math.sin(c)+SpriteUtil.stageCenterX,g.y=r*Math.cos(c)+i*Math.sin(c)+SpriteUtil.stageCenterY,this.enemies.push({index:f,angle:c,shape:g}),this.addChild(g),this.playAnim(g).then(function(){console.log("good")})}},e.prototype.playAnim=function(t){var e=new Promise(function(e,i){t.scaleX=0,t.scaleY=0,egret.Tween.get(t).to({scaleX:1,scaleY:1},200).call(function(){egret.Tween.removeTweens(t)})});return e},e.prototype.playDestroy=function(t){var e=this,i=new Promise(function(i,r){for(var a=t.num,s=0,n=t.points,o=function(){var r=SpriteUtil.createCircle(t.radius+t.radius*Math.random(),e.getColor());e.addChild(r),r.x=t.x,r.y=t.y;var o=n[s%a];egret.Tween.get(r).to({x:o.x,y:o.y},300,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(r),e.removeChild(r),s==a&&i()}),s++};a>s;)o()});return i},e.prototype.calculateAngle=function(t,e,i,r){for(var a=360/r,s=[],n=0;r>n;n++){var o=e+3*t*Math.random()*Math.cos(n*a/Math.PI),h=i-3*t*Math.random()*Math.sin(n*a/Math.PI);s.push({x:o,y:h})}return s},e.prototype.getColor=function(){var t=[16711680,16776960,16743680,255,16711935,65535,0],e=Math.floor(t.length*Math.random());return t[e]},e}(BaseScene);__reflect(Scene_031.prototype,"Scene_031");var Scene_032=function(t){function e(){var e=t.call(this)||this;return e.curIndex=-1,e.colors=[],e.balls=[],e.score=0,e.isCanOperate=!0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.colors=[16711680,16776960,16743680,255,16711935,65535,0];var t=SpriteUtil.createText("红",160);t.x=SpriteUtil.stageCenterX,t.y=SpriteUtil.stageCenterY,this.addChild(t),this.titleTxt=t,this.next(),this.timeItem=new TimeItem(this.dataVo.time),this.addChild(this.timeItem),this.timeItem.x=SpriteUtil.stageWidth-250,this.scoreItem=new ScoreItem,this.scoreItem.setSTScore(this.score,this.dataVo.tData),this.addChild(this.scoreItem)
},e.prototype.touchHandler=function(t){if(this.isCanOperate){var e=t.target,i=e.name.split("_")[1];if(this.curIndex==i){if(this.score++,this.scoreItem.setSTScore(this.score),this.scoreItem.isCanPass())return this.timeItem.stop(),this.clear(),EffectUtil.showResultEffect(EffectUtil.PERFECT),void(this.isCanOperate=!1);this.next()}else this.timeItem.stop(),this.isCanOperate=!1,EffectUtil.showResultEffect()}},e.prototype.next=function(){var t=this.getTxtColor();this.curIndex=t.index,this.titleTxt.textColor=t.color,this.titleTxt.text=t.name,this.createBalls(t.index)},e.prototype.createBalls=function(t){var e=this;this.clear();for(var i=this.dataVo.sData,r=function(t){var i=SpriteUtil.createCircle(30+50*Math.random(),a.colors[t]);i.x=i.width/2+(SpriteUtil.stageWidth-i.width)*Math.random(),i.y=i.width/2+(SpriteUtil.stageHeight-400)*Math.random(),a.addChild(i),i.alpha=.8,i.name="color_"+t,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,a.touchHandler,a),i.scaleX=0,i.scaleY=0,a.balls.push(i),egret.Tween.get(i).to({scaleX:1,scaleY:1},200).call(function(){egret.Tween.removeTweens(i),e.playAnim(i)})},a=this,s=0;i>s;s++)r(s)},e.prototype.clear=function(){for(var t=0;t<this.balls.length;t++)egret.Tween.removeTweens(this.balls[t]),this.removeChild(this.balls[t]);this.balls.length=0},e.prototype.playAnim=function(t){var e=this;egret.Tween.get(t).to({x:t.width/2+(SpriteUtil.stageWidth-t.width)*Math.random(),y:t.width/2+(SpriteUtil.stageHeight-400)*Math.random()},2e3).call(function(){egret.Tween.removeTweens(t),e.playAnim(t)})},e.prototype.enter=function(){t.prototype.enter.call(this),this.timeItem.start()},e.prototype.getTxtColor=function(){var t=Math.floor(this.colors.length*Math.random()),e=["红","黄","橙","蓝","紫","青","黑"],i=Math.floor(this.dataVo.sData*Math.random());return{index:i,color:this.colors[t],name:e[i]}},e}(BaseScene);__reflect(Scene_032.prototype,"Scene_032");var CommonUtil=function(){function t(){}return t.getMSTimeBySeconds=function(t){void 0===t&&(t=0);var e=Math.floor(t/60)<10?"0"+Math.floor(t/60):Math.floor(t/60),i=10>t%60?"0"+t%60:t%60;return e+":"+i},t.getRandomNumFromARange=function(t,e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=!1),!t||e>=i)return null;for(var a=i-e,s=[],n=0;a>n;n++)s.push(e+n);if(t>=a)return s;for(var o=[],n=0;t>n;n++){var h=Math.floor(s.length*Math.random());o.push(s[h]),s.splice(h,1)}return o},t.allEmoji=["emoji01","emoji02","emoji03","emoji04","emoji05","emoji06","emoji07","emoji08","emoji09","emoji10","emoji11","emoji12","emoji13","emoji14","emoji15","emoji16","emoji17","emoji18","emoji19","emoji20","equal","female","male","sigh","rock","paper","scissors","welldone"],t.allAnimals=["ant","butterfly","cat","chicken","cow","dog","dragon","dragonfly","duck","eagle","elephant","frog","goat","horse","lizard","monkey","panda","penguin","pork","rabbit","rat","snake","squab","tiger","tortoise"],t}();__reflect(CommonUtil.prototype,"CommonUtil");var EffectUtil=function(){function t(){}return t.showResultEffect=function(t){var e=this;void 0===t&&(t=0);var i="you lose";1==t?i="good":2==t?i="great":3==t&&(i="perfect"),0==t?GameSound.instance().playSound("fail"):GameSound.instance().playSound(i);var r=SpriteUtil.createText(i,100,16766720);r.stroke=5,r.strokeColor=16711680,r.bold=!0,r.x=SpriteUtil.stageCenterX,r.y=SpriteUtil.stageCenterY-200,r.scaleX=5,r.scaleY=5,r.alpha=.1,Game.instance().addMiddle(r),egret.Tween.get(r).to({scaleX:1,scaleY:1,alpha:1},500,egret.Ease.cubicIn).call(function(){var i=egret.setTimeout(function(){egret.clearTimeout(i),r.parent&&r.parent.removeChild(r),0==t?GameData.reviveCard<=0?(GameData.reviveCard=0,Game.instance().gameView.tipsView.open(!1)):Game.instance().gameView.tipsView.open():EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.GOTO_NEXT_LEVEL))},e,800)})},t.playReadyGo=function(){var t=this,e=SpriteUtil.createText("Ready",100,5570463);e.stroke=5,e.strokeColor=16711935,e.bold=!0,e.x=SpriteUtil.stageCenterX,e.y=SpriteUtil.stageCenterY-200,e.scaleX=5,e.scaleY=5,e.alpha=.1,Game.instance().addMiddle(e),GameSound.instance().playSound("ready"),egret.Tween.get(e).to({scaleX:1,scaleY:1,alpha:1},300,egret.Ease.cubicIn).call(function(){var i=egret.setTimeout(function(){egret.clearTimeout(i),e.alpha=.01,e.text="Go",e.scaleX=5,e.scaleY=5,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,egret.Tween.get(e).to({scaleX:1,scaleY:1,alpha:1},300,egret.Ease.cubicIn).call(function(){var i=egret.setTimeout(function(){egret.clearTimeout(i),e.parent&&e.parent.removeChild(e),egret.Tween.removeTweens(e),EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.START_GAME))},t,200)})},t,400)})},t.showTextAndBack=function(t,e,i){var r=this;if(void 0===t&&(t=""),void 0===e&&(e=null),void 0===i&&(i=null),t){var a=SpriteUtil.createText(t,100,16776960);a.stroke=5,a.strokeColor=255,a.bold=!0,a.x=SpriteUtil.stageCenterX,a.y=SpriteUtil.stageCenterY-200,a.scaleX=5,a.scaleY=5,a.alpha=.1,Game.instance().addMiddle(a),egret.Tween.get(a).to({scaleX:1,scaleY:1,alpha:1},500,egret.Ease.cubicIn).call(function(){var t=egret.setTimeout(function(){egret.clearTimeout(t),a.parent&&a.parent.removeChild(a),egret.Tween.removeTweens(a),e&&(i?e.call(i):e())},r,800)})}},t.breath=function(t,e){void 0===e&&(e=.8);var i=t.scaleX,r=t.scaleY;egret.Tween.get(t,{loop:!0}).to({scaleX:i+e,scaleY:r+e},500).to({scaleX:i,scaleY:r},500)},t.GOOD=1,t.GREAT=2,t.PERFECT=3,t}();__reflect(EffectUtil.prototype,"EffectUtil");var SpriteUtil=function(){function t(){}return t.createCircle=function(t,e){void 0===e&&(e=65280);var i=new egret.Shape;return i.graphics.beginFill(e),i.graphics.drawCircle(0,0,t),i.graphics.endFill(),i},t.createRect=function(t,e,i,r){void 0===i&&(i=65280),void 0===r&&(r=!1);var a=new egret.Shape;return a.graphics.beginFill(i),r&&a.graphics.lineStyle(1,0),a.graphics.drawRect(0,0,t,e),a.graphics.endFill(),a.anchorOffsetX=t/2,a.anchorOffsetY=e/2,a},t.createPolygon=function(t,e){if(void 0===e&&(e=255),t&&t.length){var i=new egret.Shape,r=t.length;i.graphics.lineStyle(1,e),i.graphics.beginFill(e),i.graphics.moveTo(t[0],t[1]);for(var a=0;r>a;a+=2)i.graphics.lineTo(t[a],t[a+1]);return i.graphics.lineTo(t[0],t[1]),i.graphics.endFill(),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i}},t.createText=function(t,e,i,r,a){void 0===e&&(e=40),void 0===i&&(i=16711680),void 0===r&&(r=!1),void 0===a&&(a=255);var s=new egret.TextField;return s.size=e,s.text=t,s.textColor=i,s.background=r,s.backgroundColor=a,s.stroke=1,s.strokeColor=13479168,s.textAlign="center",s.verticalAlign="middle",s.bold=!0,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s},t.createImage=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=10467021);var r=new egret.Bitmap(RES.getRes("images_json#"+t));if(e){var a=new egret.Sprite;return a.graphics.beginFill(i),a.graphics.drawRect(0,0,r.width,r.height),a.graphics.endFill(),a.addChild(r),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.touchEnabled=!0,a}return r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.touchEnabled=!0,r},t.createButton=function(t,e,i,r,a,s,n){void 0===e&&(e=200),void 0===i&&(i=80),void 0===r&&(r=65280),void 0===a&&(a=40),void 0===s&&(s=0),void 0===n&&(n=6710886);var o=new egret.Sprite,h=new egret.Shape;h.graphics.lineStyle(s,n),h.graphics.beginFill(r),h.graphics.drawRoundRect(0,0,e,i,i),h.graphics.endFill();var l=new egret.TextField;return l.text=t,l.size=a,l.textAlign="center",l.width=e,l.y=25,l.stroke=1,l.strokeColor=3355443,l.bold=!0,l.touchEnabled=!1,o.addChild(h),o.addChild(l),o.touchEnabled=!0,o},t.stageWidth=0,t.stageHeight=0,t.stageCenterX=0,t.stageCenterY=0,t}();__reflect(SpriteUtil.prototype,"SpriteUtil");var WXApi=function(){function t(){}return t.getSetting=function(){wx.getSetting({complete:function(e){if("getSetting:ok"==e.errMsg){var i=e.authSetting;if(1==i["scope.userInfo"]){var r=egret.localStorage.getItem("very_funny_small_game_user_avatar_url");r?EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.AUTHORIZE_REFRESH)):wx.getUserInfo({success:function(t){GameData.wxUserInfo=t.userInfo,egret.localStorage.setItem("very_funny_small_game_user_avatar_url",t.userInfo.avatarUrl),EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.AUTHORIZE_REFRESH))}}),t.showShareMenu()}else t.createUserInfoButton()}else console.error(e)}})},t.showModal=function(t){wx.showModal(t)},t.createUserInfoButton=function(){if("wxgame"!=egret.Capabilities.runtimeType)return void Game.instance().gameScene.enterMenu();var e=wx.getSystemInfoSync(),i=wx.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:e.windowWidth,height:e.windowHeight,backgroundColor:"#0000ff",color:"#ffff00",textAlign:"center",fontSize:48,opacity:.1,borderRadius:0}});i.onTap(function(e){"getUserInfo:ok"==e.errMsg&&(i.hide(),i.destroy(),t.showShareMenu(),GameData.wxUserInfo=e.userInfo,egret.localStorage.setItem("very_funny_small_game_user_avatar_url",e.userInfo.avatarUrl),EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.AUTHORIZE_REFRESH)))})},t.showShareMenu=function(){wx.showShareMenu({withShareTicket:!1,complete:function(t){wx.onShareAppMessage(function(){var t=GameData.shareConf[Math.floor(GameData.shareConf.length*Math.random())];return{title:t.title,imageUrl:t.head,query:""}})}})},t.shareAppMessage=function(){var t=GameData.shareConf[Math.floor(GameData.shareConf.length*Math.random())];wx.shareAppMessage({title:t.title,imageUrl:t.head,query:""})},t.createInnerAudioContext=function(t){var e=wx.createInnerAudioContext();return e.src=t,e},t.createGameClubButton=function(){var t=wx.createGameClubButton({icon:"green",style:{left:10,top:10,width:40,height:40}});return t},t.navigateToMiniProgram=function(t){wx.navigateToMiniProgram({appId:t,success:function(){}})},t.showBannerAd=function(t){var e=this;if(void 0===t&&(t=!0),GameData.isWxGame)if(this.globalBannerAd)t?this.globalBannerAd.show():this.globalBannerAd.hide();else{var i=wx.getSystemInfoSync(),r=SpriteUtil.stageHeight,a=SpriteUtil.stageWidth;r>i.windowHeight&&(r=i.windowHeight*a/i.windowWidth);var s=wx.createBannerAd({adUnitId:"adunit-3f56016b3591065a",style:{left:0,top:0,width:a}});s.onResize(function(r){s.style.left=0,s.style.top=i.windowHeight-r.height,e.globalBannerAd=s,t?s.show():s.hide()}),s.onError(function(t){console.log(t.errMsg)})}},t.showVideoAd=function(){var t=wx.createRewardedVideoAd({adUnitId:"adunit-37768ba621106947"});return t},t.updateRankLvl=function(t){var e=egret.localStorage.getItem("very_funny_small_game_chapter");if(!(parseInt(e)>=t)&&(egret.localStorage.setItem("very_funny_small_game_chapter",""+t),GameData.isWxGame)){var i=platform.openDataContext;i.postMessage({command:"cmd_user",level:t})}},t}();__reflect(WXApi.prototype,"WXApi");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=420,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.textColor=65280,this.textField.size=48,this.textField.stroke=2,this.textField.strokeColor=16711680,this.textField.bold=!0;var t=new egret.TextField;t.text="健康游戏忠告\n抵制不良游戏，拒绝盗版游戏。\n注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。\n合理安排时间，享受健康生活。",t.textAlign="center",t.textColor=16777215,t.lineSpacing=20,t.size=36,t.anchorOffsetX=t.width/2,t.x=360,t.y=700,this.addChild(t)},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+Math.floor(100*t/e)+"%",this.textField.x=120},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var GuideView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),e.graphics.endFill(),this.addChild(e),this.tipsTxt=new egret.TextField,this.tipsTxt.name="",this.tipsTxt.textAlign="center",this.tipsTxt.size=40,this.tipsTxt.textColor=16777215,this.tipsTxt.stroke=1,this.tipsTxt.strokeColor=16711680,this.tipsTxt.bold=!0,this.tipsTxt.lineSpacing=20,this.tipsTxt.width=SpriteUtil.stageWidth-200,this.tipsTxt.x=(SpriteUtil.stageWidth-this.tipsTxt.width)/2,this.addChild(this.tipsTxt);var i=SpriteUtil.createText(">> 开始挑战 <<",48,16776960);i.x=SpriteUtil.stageCenterX,i.y=SpriteUtil.stageCenterY-80,i.touchEnabled=!0,this.addChild(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSound.instance().playSound("click"),t.close(),EffectUtil.playReadyGo()},this),this.startBtn=i,EffectUtil.breath(i,.05);var r=SpriteUtil.createImage("home");r.x=80,r.y=80,r.scaleX=1.4,r.scaleY=1.5,this.addChild(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close(),Game.instance().gameScene.enterMenu()},this)},e.prototype.show=function(){this.tipsTxt.textFlow=this.getDesc(),t.prototype.open.call(this),this.tipsTxt.y=SpriteUtil.stageCenterY-this.tipsTxt.height/2-100,this.startBtn.y=this.tipsTxt.y+this.tipsTxt.height+60},e.prototype.getDesc=function(){var t=GameData.getLevelConfig(),e=new Array;return e.push({text:t.title,style:{bold:!0,size:40,textColor:16761125}}),e.push({text:"\n"}),e.push({text:t.desc,style:{size:32,bold:!1,textColor:15658705,stroke:0}}),e},e}(BaseView);__reflect(GuideView.prototype,"GuideView");var RankView=function(t){function e(){var e=t.call(this)||this;return e.intervalId=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,e=new egret.Shape;e.graphics.beginFill(0,.96),e.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),e.graphics.endFill(),this.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close()},this),this.listSpr=new egret.Sprite,this.listSpr.y=100,this.addChild(this.listSpr);var i=new egret.TextField;i.text="排行榜",i.x=SpriteUtil.stageCenterX-i.width/2,i.y=80,i.size=40,i.textColor=16776960,i.bold=!0,this.addChild(i)},e.prototype.open=function(){var e=this;t.prototype.open.call(this),this.intervalId=egret.setInterval(function(){e.listSpr.removeChildren();var t=platform.openDataContext;t.postMessage({command:"cmd_rank"});var i=t.createDisplayObject(),r=SpriteUtil.stageWidth/i.width;e.listSpr.addChild(i),e.listSpr.scaleX=r,e.listSpr.scaleY=r},this,40)},e.prototype.close=function(){t.prototype.close.call(this),egret.clearInterval(this.intervalId)},e}(BaseView);__reflect(RankView.prototype,"RankView");var TipsView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,e=new egret.Shape;e.graphics.beginFill(0,.5),e.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),e.graphics.endFill(),this.addChild(e),e.touchEnabled=!0;var i=new egret.Sprite;this.addChild(i);var r=new egret.Shape;r.graphics.beginFill(3447003),r.graphics.drawRoundRect(0,0,SpriteUtil.stageWidth/1.2,SpriteUtil.stageWidth/1.8,50),r.graphics.endFill(),i.addChild(r);var a=SpriteUtil.createText("提示",42,65280);a.x=r.width/2,a.y=50,i.addChild(a);var s=SpriteUtil.createText("你有1次复活机会！",36,16777215);s.anchorOffsetX=0,s.anchorOffsetY=0,s.x=50,s.y=100,s.width=r.width-100,s.height=160,s.lineSpacing=20,i.addChild(s),this.tipsTxt=s;var n=SpriteUtil.createText("X",48,15792383);n.bold=!0,n.stroke=1,n.strokeColor=15658734,n.x=r.width-35,n.y=32,n.touchEnabled=!0,i.addChild(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.close(),Game.instance().gameScene.enterOver()},this);var o=SpriteUtil.createButton("立即复活",200,80,65280,32);o.x=r.width/2-o.width-40,o.y=r.height-100,i.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameData.reviveCard<=0||(t.close(),GameData.reviveCard--,GameData.currentLevel--,EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.GOTO_NEXT_LEVEL)))},this),this.reviveBtn=o;var h=SpriteUtil.createButton("看视频复活",200,80,65280,32);h.x=r.width/2+40,h.y=r.height-100,i.addChild(h),this.lookBtn=h;var l=new egret.Shape;l.graphics.beginFill(0),l.graphics.drawRect(0,0,SpriteUtil.stageWidth,SpriteUtil.stageHeight),l.graphics.endFill(),l.touchEnabled=!0,l.alpha=.6,this.background=l,h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var e=WXApi.showVideoAd();Game.instance().addTop(l),e.onError(function(t){l&&l.parent&&l.parent.removeChild(l),console.log(t.errMsg)}),e.load().then(function(){e.show(),e.onClose(function(e){1==e.isEnded&&(t.close(),GameData.currentLevel--,EventCenter.instance().dispatchEvent(new GameEvent(GameEvent.GOTO_NEXT_LEVEL))),l&&l.parent&&l.parent.removeChild(l)})})["catch"](function(t){l&&l.parent&&l.parent.removeChild(l),console.log(t.errMsg)})},this),i.x=SpriteUtil.stageCenterX-r.width/2,i.y=SpriteUtil.stageCenterY-r.height/2},e.prototype.open=function(e){void 0===e&&(e=!0),this.reviveBtn.visible=e,e?(this.tipsTxt.text="你还剩余"+GameData.reviveCard+"次复活机会！",this.lookBtn.x=SpriteUtil.stageWidth/1.2/2+40):(this.lookBtn.x=SpriteUtil.stageWidth/1.2/2-this.lookBtn.width/2,this.tipsTxt.text="您的免费复活次数已用光\n可以看视频复活！"),t.prototype.open.call(this)},e}(BaseView);__reflect(TipsView.prototype,"TipsView");var DataVO=function(){function t(){this.level=0,this.levelType="000",this.title="神秘的关卡",this.desc="能告诉我你是怎么来到这里的吗？",this.time=0,this.score=0,this.extData=null}return t.prototype.setData=function(t){this.reset(),t&&(this.level=t.level?t.level:this.level,this.levelType=t.levelType?t.levelType:this.levelType,this.title=t.title?t.title:this.title,this.desc=t.desc?t.desc:this.desc,this.sData=t.sData?t.sData:this.sData,this.tData=t.tData?t.tData:this.tData,this.time=t.time?t.time:this.time,this.score=t.score?t.score:this.score,this.extData=t.extData?t.extData:this.extData)},t.prototype.reset=function(){this.level=0,this.levelType="",this.title="神秘的关卡",this.desc="能告诉我你是怎么来到这里的吗？",this.sData=null,this.tData=null,this.time=0,this.score=0},t}();__reflect(DataVO.prototype,"DataVO"),window.Main=Main;